2015-04-27 19:53:30+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_maichu': 1954779241.0,
	 'rongquan_yuliang': 806776144.0,
	 'rongquan_yuliang_jine': 5886540287.0,
	 'rongzi_mairu': 165794251895.0,
	 'rongzi_yue': 1143069525623.0,
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 23, in process_item
	    db_item = db.Rongzi(trading_day = item["item.trading_day"],
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/item.py", line 50, in __getitem__
	    return self._values[key]
	exceptions.KeyError: 'item.trading_day'
	
2015-04-27 19:53:30+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 206536856.0,
	 'rongquan_maichu': 204946120.0,
	 'rongquan_yuliang': 120663212.0,
	 'rongzi_changhuan': 1338705276.0,
	 'rongzi_mairu': 1209539234.0,
	 'rongzi_yue': 24053706712.0,
	 'stock_code': u'510050',
	 'stock_name': u'50ETF',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 32388025.0,
	 'rongquan_maichu': 28629200.0,
	 'rongquan_yuliang': 45964906.0,
	 'rongzi_changhuan': 218625590.0,
	 'rongzi_mairu': 175256972.0,
	 'rongzi_yue': 6403315572.0,
	 'stock_code': u'510180',
	 'stock_name': u'180ETF',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 0.0,
	 'rongzi_changhuan': 13701820.0,
	 'rongzi_mairu': 32646321.0,
	 'rongzi_yue': 148206794.0,
	 'stock_code': u'510230',
	 'stock_name': u'\u91d1\u878dETF',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 313107183.0,
	 'rongquan_maichu': 303906298.0,
	 'rongquan_yuliang': 419222791.0,
	 'rongzi_changhuan': 1510350432.0,
	 'rongzi_mairu': 1282260795.0,
	 'rongzi_yue': 59636582171.0,
	 'stock_code': u'510300',
	 'stock_name': u'300ETF',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 100000.0,
	 'rongzi_changhuan': 2302636.0,
	 'rongzi_mairu': 1405727.0,
	 'rongzi_yue': 11540392.0,
	 'stock_code': u'510310',
	 'stock_name': u'HS300ETF',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 218300.0,
	 'rongquan_maichu': 541000.0,
	 'rongquan_yuliang': 3984600.0,
	 'rongzi_changhuan': 6144813.0,
	 'rongzi_mairu': 7319318.0,
	 'rongzi_yue': 40574824.0,
	 'stock_code': u'510330',
	 'stock_name': u'\u534e\u590f300',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 3300.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 2514892.0,
	 'rongzi_changhuan': 5669809.0,
	 'rongzi_mairu': 5688203.0,
	 'rongzi_yue': 71496470.0,
	 'stock_code': u'510500',
	 'stock_name': u'500ETF',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 451400.0,
	 'rongquan_maichu': 1592500.0,
	 'rongquan_yuliang': 4657109.0,
	 'rongzi_changhuan': 3873209.0,
	 'rongzi_mairu': 3186117.0,
	 'rongzi_yue': 31893370.0,
	 'stock_code': u'510510',
	 'stock_name': u'\u5e7f\u53d1500',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 490100.0,
	 'rongquan_maichu': 127400.0,
	 'rongquan_yuliang': 2457915.0,
	 'rongzi_changhuan': 8283492.0,
	 'rongzi_mairu': 3382274.0,
	 'rongzi_yue': 110032283.0,
	 'stock_code': u'510880',
	 'stock_name': u'\u7ea2\u5229ETF',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 0.0,
	 'rongzi_changhuan': 27088.0,
	 'rongzi_mairu': 3847893.0,
	 'rongzi_yue': 3820805.0,
	 'stock_code': u'512990',
	 'stock_name': u'MSCIA\u80a1',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 29659080.0,
	 'rongquan_maichu': 29250087.0,
	 'rongquan_yuliang': 4034993.0,
	 'rongzi_changhuan': 2216407797.0,
	 'rongzi_mairu': 1887386006.0,
	 'rongzi_yue': 18581693170.0,
	 'stock_code': u'600000',
	 'stock_name': u'\u6d66\u53d1\u94f6\u884c',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 712500.0,
	 'rongquan_maichu': 708900.0,
	 'rongquan_yuliang': 557200.0,
	 'rongzi_changhuan': 307710381.0,
	 'rongzi_mairu': 396643916.0,
	 'rongzi_yue': 1644446108.0,
	 'stock_code': u'600005',
	 'stock_name': u'\u6b66\u94a2\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 10000.0,
	 'rongzi_changhuan': 150511375.0,
	 'rongzi_mairu': 201045859.0,
	 'rongzi_yue': 962225148.0,
	 'stock_code': u'600006',
	 'stock_name': u'\u4e1c\u98ce\u6c7d\u8f66',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 5800.0,
	 'rongquan_maichu': 15000.0,
	 'rongquan_yuliang': 28200.0,
	 'rongzi_changhuan': 29808601.0,
	 'rongzi_mairu': 29156423.0,
	 'rongzi_yue': 253096771.0,
	 'stock_code': u'600007',
	 'stock_name': u'\u4e2d\u56fd\u56fd\u8d38',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 907000.0,
	 'rongquan_maichu': 954800.0,
	 'rongquan_yuliang': 245900.0,
	 'rongzi_changhuan': 391949034.0,
	 'rongzi_mairu': 225601070.0,
	 'rongzi_yue': 1553726334.0,
	 'stock_code': u'600008',
	 'stock_name': u'\u9996\u521b\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 370012.0,
	 'rongquan_maichu': 400620.0,
	 'rongquan_yuliang': 641128.0,
	 'rongzi_changhuan': 89575454.0,
	 'rongzi_mairu': 95869125.0,
	 'rongzi_yue': 686555655.0,
	 'stock_code': u'600009',
	 'stock_name': u'\u4e0a\u6d77\u673a\u573a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 19234376.0,
	 'rongquan_maichu': 19267676.0,
	 'rongquan_yuliang': 2726977.0,
	 'rongzi_changhuan': 990072923.0,
	 'rongzi_mairu': 993248477.0,
	 'rongzi_yue': 7863604821.0,
	 'stock_code': u'600010',
	 'stock_name': u'\u5305\u94a2\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 6683226.0,
	 'rongquan_maichu': 6290189.0,
	 'rongquan_yuliang': 1017760.0,
	 'rongzi_changhuan': 552785946.0,
	 'rongzi_mairu': 279783636.0,
	 'rongzi_yue': 1605863195.0,
	 'stock_code': u'600011',
	 'stock_name': u'\u534e\u80fd\u56fd\u9645',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 23825365.0,
	 'rongquan_maichu': 27247398.0,
	 'rongquan_yuliang': 5625438.0,
	 'rongzi_changhuan': 754773161.0,
	 'rongzi_mairu': 647130317.0,
	 'rongzi_yue': 4749199653.0,
	 'stock_code': u'600015',
	 'stock_name': u'\u534e\u590f\u94f6\u884c',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 30610760.0,
	 'rongquan_maichu': 30918760.0,
	 'rongquan_yuliang': 7810965.0,
	 'rongzi_changhuan': 1415659197.0,
	 'rongzi_mairu': 1106510547.0,
	 'rongzi_yue': 9484852278.0,
	 'stock_code': u'600016',
	 'stock_name': u'\u6c11\u751f\u94f6\u884c',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 376600.0,
	 'rongquan_maichu': 376600.0,
	 'rongquan_yuliang': 79695.0,
	 'rongzi_changhuan': 282866939.0,
	 'rongzi_mairu': 237034146.0,
	 'rongzi_yue': 995054115.0,
	 'stock_code': u'600017',
	 'stock_name': u'\u65e5\u7167\u6e2f',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 6866166.0,
	 'rongquan_maichu': 6214585.0,
	 'rongquan_yuliang': 336474.0,
	 'rongzi_changhuan': 507794400.0,
	 'rongzi_mairu': 612447352.0,
	 'rongzi_yue': 1776302890.0,
	 'stock_code': u'600018',
	 'stock_name': u'\u4e0a\u6e2f\u96c6\u56e2',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 9512459.0,
	 'rongquan_maichu': 9575659.0,
	 'rongquan_yuliang': 1795841.0,
	 'rongzi_changhuan': 1040844684.0,
	 'rongzi_mairu': 682925142.0,
	 'rongzi_yue': 2342318011.0,
	 'stock_code': u'600019',
	 'stock_name': u'\u5b9d\u94a2\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 415800.0,
	 'rongquan_maichu': 412700.0,
	 'rongquan_yuliang': 44800.0,
	 'rongzi_changhuan': 338929645.0,
	 'rongzi_mairu': 370090032.0,
	 'rongzi_yue': 1964034344.0,
	 'stock_code': u'600021',
	 'stock_name': u'\u4e0a\u6d77\u7535\u529b',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 563500.0,
	 'rongquan_maichu': 652600.0,
	 'rongquan_yuliang': 343200.0,
	 'rongzi_changhuan': 183787346.0,
	 'rongzi_mairu': 167189999.0,
	 'rongzi_yue': 834442938.0,
	 'stock_code': u'600022',
	 'stock_name': u'\u5c71\u4e1c\u94a2\u94c1',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 1007632.0,
	 'rongquan_maichu': 1006300.0,
	 'rongquan_yuliang': 500117.0,
	 'rongzi_changhuan': 245629495.0,
	 'rongzi_mairu': 324536216.0,
	 'rongzi_yue': 1189812359.0,
	 'stock_code': u'600023',
	 'stock_name': u'\u6d59\u80fd\u7535\u529b',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 175800.0,
	 'rongquan_maichu': 117200.0,
	 'rongquan_yuliang': 1500.0,
	 'rongzi_changhuan': 789881574.0,
	 'rongzi_mairu': 665043460.0,
	 'rongzi_yue': 1672412228.0,
	 'stock_code': u'600026',
	 'stock_name': u'\u4e2d\u6d77\u53d1\u5c55',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 4893317.0,
	 'rongquan_maichu': 4918511.0,
	 'rongquan_yuliang': 583295.0,
	 'rongzi_changhuan': 261136992.0,
	 'rongzi_mairu': 274633388.0,
	 'rongzi_yue': 1694930715.0,
	 'stock_code': u'600027',
	 'stock_name': u'\u534e\u7535\u56fd\u9645',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 6100921.0,
	 'rongquan_maichu': 6072000.0,
	 'rongquan_yuliang': 1236037.0,
	 'rongzi_changhuan': 1904010073.0,
	 'rongzi_mairu': 1684879747.0,
	 'rongzi_yue': 9920005512.0,
	 'stock_code': u'600028',
	 'stock_name': u'\u4e2d\u56fd\u77f3\u5316',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 6013947.0,
	 'rongquan_maichu': 6317247.0,
	 'rongquan_yuliang': 1627000.0,
	 'rongzi_changhuan': 675617778.0,
	 'rongzi_mairu': 672108767.0,
	 'rongzi_yue': 3578290322.0,
	 'stock_code': u'600029',
	 'stock_name': u'\u5357\u65b9\u822a\u7a7a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 37851261.0,
	 'rongquan_maichu': 37649564.0,
	 'rongquan_yuliang': 2021222.0,
	 'rongzi_changhuan': 4794651963.0,
	 'rongzi_mairu': 3999031365.0,
	 'rongzi_yue': 40189130401.0,
	 'stock_code': u'600030',
	 'stock_name': u'\u4e2d\u4fe1\u8bc1\u5238',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 6938072.0,
	 'rongquan_maichu': 6946972.0,
	 'rongquan_yuliang': 581376.0,
	 'rongzi_changhuan': 997701395.0,
	 'rongzi_mairu': 1001011524.0,
	 'rongzi_yue': 3193228452.0,
	 'stock_code': u'600031',
	 'stock_name': u'\u4e09\u4e00\u91cd\u5de5',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 29301260.0,
	 'rongquan_maichu': 29654143.0,
	 'rongquan_yuliang': 6711980.0,
	 'rongzi_changhuan': 1074255100.0,
	 'rongzi_mairu': 1482218536.0,
	 'rongzi_yue': 9880439028.0,
	 'stock_code': u'600036',
	 'stock_name': u'\u62db\u5546\u94f6\u884c',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 160999.0,
	 'rongquan_maichu': 160999.0,
	 'rongquan_yuliang': 78786.0,
	 'rongzi_changhuan': 189449359.0,
	 'rongzi_mairu': 262762777.0,
	 'rongzi_yue': 1464713496.0,
	 'stock_code': u'600037',
	 'stock_name': u'\u6b4c\u534e\u6709\u7ebf',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 211119.0,
	 'rongquan_maichu': 208000.0,
	 'rongquan_yuliang': 78281.0,
	 'rongzi_changhuan': 149150950.0,
	 'rongzi_mairu': 187724671.0,
	 'rongzi_yue': 1310466421.0,
	 'stock_code': u'600038',
	 'stock_name': u'\u4e2d\u76f4\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 445100.0,
	 'rongquan_maichu': 448100.0,
	 'rongquan_yuliang': 61738.0,
	 'rongzi_changhuan': 337740183.0,
	 'rongzi_mairu': 365529743.0,
	 'rongzi_yue': 1860627445.0,
	 'stock_code': u'600039',
	 'stock_name': u'\u56db\u5ddd\u8def\u6865',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 10910737.0,
	 'rongquan_maichu': 10871828.0,
	 'rongquan_yuliang': 2260334.0,
	 'rongzi_changhuan': 1485968275.0,
	 'rongzi_mairu': 1199138410.0,
	 'rongzi_yue': 7197324622.0,
	 'stock_code': u'600048',
	 'stock_name': u'\u4fdd\u5229\u5730\u4ea7',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 15418421.0,
	 'rongquan_maichu': 15761800.0,
	 'rongquan_yuliang': 2692978.0,
	 'rongzi_changhuan': 1649789367.0,
	 'rongzi_mairu': 1384488781.0,
	 'rongzi_yue': 6011261003.0,
	 'stock_code': u'600050',
	 'stock_name': u'\u4e2d\u56fd\u8054\u901a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 140390.0,
	 'rongquan_maichu': 153190.0,
	 'rongquan_yuliang': 14300.0,
	 'rongzi_changhuan': 183711026.0,
	 'rongzi_mairu': 166419857.0,
	 'rongzi_yue': 1094204006.0,
	 'stock_code': u'600056',
	 'stock_name': u'\u4e2d\u56fd\u533b\u836f',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 830251.0,
	 'rongquan_maichu': 855395.0,
	 'rongquan_yuliang': 129570.0,
	 'rongzi_changhuan': 214406036.0,
	 'rongzi_mairu': 306519004.0,
	 'rongzi_yue': 1033276027.0,
	 'stock_code': u'600058',
	 'stock_name': u'\u4e94\u77ff\u53d1\u5c55',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 137599.0,
	 'rongquan_maichu': 132699.0,
	 'rongquan_yuliang': 180200.0,
	 'rongzi_changhuan': 67257706.0,
	 'rongzi_mairu': 68091789.0,
	 'rongzi_yue': 898449871.0,
	 'stock_code': u'600059',
	 'stock_name': u'\u53e4\u8d8a\u9f99\u5c71',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 656876.0,
	 'rongquan_maichu': 662017.0,
	 'rongquan_yuliang': 259776.0,
	 'rongzi_changhuan': 107826849.0,
	 'rongzi_mairu': 133420834.0,
	 'rongzi_yue': 3138137128.0,
	 'stock_code': u'600060',
	 'stock_name': u'\u6d77\u4fe1\u7535\u5668',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 14100.0,
	 'rongquan_yuliang': 147233.0,
	 'rongzi_changhuan': 11166046.0,
	 'rongzi_mairu': 0.0,
	 'rongzi_yue': 596066321.0,
	 'stock_code': u'600062',
	 'stock_name': u'\u534e\u6da6\u53cc\u9e64',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 127400.0,
	 'rongquan_maichu': 133400.0,
	 'rongquan_yuliang': 48800.0,
	 'rongzi_changhuan': 129128065.0,
	 'rongzi_mairu': 141747590.0,
	 'rongzi_yue': 1112128723.0,
	 'stock_code': u'600063',
	 'stock_name': u'\u7696\u7ef4\u9ad8\u65b0',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 347064.0,
	 'rongquan_maichu': 290853.0,
	 'rongquan_yuliang': 501756.0,
	 'rongzi_changhuan': 62005097.0,
	 'rongzi_mairu': 113163338.0,
	 'rongzi_yue': 946490395.0,
	 'stock_code': u'600066',
	 'stock_name': u'\u5b87\u901a\u5ba2\u8f66',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 278400.0,
	 'rongquan_maichu': 338400.0,
	 'rongquan_yuliang': 241263.0,
	 'rongzi_changhuan': 292455912.0,
	 'rongzi_mairu': 244164256.0,
	 'rongzi_yue': 1162000187.0,
	 'stock_code': u'600067',
	 'stock_name': u'\u51a0\u57ce\u5927\u901a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 4274468.0,
	 'rongquan_maichu': 4288868.0,
	 'rongquan_yuliang': 558927.0,
	 'rongzi_changhuan': 1066531879.0,
	 'rongzi_mairu': 1319175632.0,
	 'rongzi_yue': 4149957185.0,
	 'stock_code': u'600068',
	 'stock_name': u'\u845b\u6d32\u575d',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 46200.0,
	 'rongquan_maichu': 46200.0,
	 'rongquan_yuliang': 70600.0,
	 'rongzi_changhuan': 85473687.0,
	 'rongzi_mairu': 54615947.0,
	 'rongzi_yue': 939129059.0,
	 'stock_code': u'600073',
	 'stock_name': u'\u4e0a\u6d77\u6885\u6797',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 13600.0,
	 'rongquan_maichu': 7400.0,
	 'rongquan_yuliang': 83700.0,
	 'rongzi_changhuan': 65061412.0,
	 'rongzi_mairu': 41281678.0,
	 'rongzi_yue': 789127456.0,
	 'stock_code': u'600077',
	 'stock_name': u'\u5b8b\u90fd\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 12400.0,
	 'rongquan_maichu': 13100.0,
	 'rongquan_yuliang': 70900.0,
	 'rongzi_changhuan': 102123963.0,
	 'rongzi_mairu': 76492915.0,
	 'rongzi_yue': 894657315.0,
	 'stock_code': u'600078',
	 'stock_name': u'\u6f84\u661f\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 171689.0,
	 'rongquan_maichu': 148465.0,
	 'rongquan_yuliang': 180230.0,
	 'rongzi_changhuan': 79647759.0,
	 'rongzi_mairu': 89669295.0,
	 'rongzi_yue': 1240488505.0,
	 'stock_code': u'600079',
	 'stock_name': u'\u4eba\u798f\u533b\u836f',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 517883.0,
	 'rongquan_maichu': 454283.0,
	 'rongquan_yuliang': 565770.0,
	 'rongzi_changhuan': 256953527.0,
	 'rongzi_mairu': 125354196.0,
	 'rongzi_yue': 1793526940.0,
	 'stock_code': u'600085',
	 'stock_name': u'\u540c\u4ec1\u5802',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 44200.0,
	 'rongzi_changhuan': 3713658.0,
	 'rongzi_mairu': 0.0,
	 'rongzi_yue': 496332708.0,
	 'stock_code': u'600086',
	 'stock_name': u'\u4e1c\u65b9\u91d1\u94b0',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 39000.0,
	 'rongquan_maichu': 38900.0,
	 'rongquan_yuliang': 11100.0,
	 'rongzi_changhuan': 72054279.0,
	 'rongzi_mairu': 51793851.0,
	 'rongzi_yue': 672034965.0,
	 'stock_code': u'600088',
	 'stock_name': u'\u4e2d\u89c6\u4f20\u5a92',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 5533776.0,
	 'rongquan_maichu': 5603788.0,
	 'rongquan_yuliang': 762141.0,
	 'rongzi_changhuan': 1017449393.0,
	 'rongzi_mairu': 1340117417.0,
	 'rongzi_yue': 5031599148.0,
	 'stock_code': u'600089',
	 'stock_name': u'\u7279\u53d8\u7535\u5de5',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 2600.0,
	 'rongquan_maichu': 1700.0,
	 'rongquan_yuliang': 84507.0,
	 'rongzi_changhuan': 28636694.0,
	 'rongzi_mairu': 33726326.0,
	 'rongzi_yue': 909453961.0,
	 'stock_code': u'600094',
	 'stock_name': u'\u5927\u540d\u57ce',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 96208.0,
	 'rongquan_maichu': 103608.0,
	 'rongquan_yuliang': 303900.0,
	 'rongzi_changhuan': 62747052.0,
	 'rongzi_mairu': 59594718.0,
	 'rongzi_yue': 434984398.0,
	 'stock_code': u'600096',
	 'stock_name': u'\u4e91\u5929\u5316',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 169200.0,
	 'rongquan_maichu': 165200.0,
	 'rongquan_yuliang': 95200.0,
	 'rongzi_changhuan': 120310396.0,
	 'rongzi_mairu': 160875267.0,
	 'rongzi_yue': 974588871.0,
	 'stock_code': u'600098',
	 'stock_name': u'\u5e7f\u5dde\u53d1\u5c55',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 1163012.0,
	 'rongquan_maichu': 1153212.0,
	 'rongquan_yuliang': 684825.0,
	 'rongzi_changhuan': 572098396.0,
	 'rongzi_mairu': 433020443.0,
	 'rongzi_yue': 5902319995.0,
	 'stock_code': u'600100',
	 'stock_name': u'\u540c\u65b9\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 3928736.0,
	 'rongquan_maichu': 4219346.0,
	 'rongquan_yuliang': 1632399.0,
	 'rongzi_changhuan': 471324915.0,
	 'rongzi_mairu': 497099834.0,
	 'rongzi_yue': 3000250340.0,
	 'stock_code': u'600104',
	 'stock_name': u'\u4e0a\u6c7d\u96c6\u56e2',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 53939.0,
	 'rongzi_changhuan': 13376048.0,
	 'rongzi_mairu': 0.0,
	 'rongzi_yue': 561336036.0,
	 'stock_code': u'600107',
	 'stock_name': u'\u7f8e\u5c14\u96c5',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 3859453.0,
	 'rongquan_maichu': 3871053.0,
	 'rongquan_yuliang': 316900.0,
	 'rongzi_changhuan': 569322894.0,
	 'rongzi_mairu': 646259249.0,
	 'rongzi_yue': 2502195204.0,
	 'stock_code': u'600108',
	 'stock_name': u'\u4e9a\u76db\u96c6\u56e2',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 2961543.0,
	 'rongquan_maichu': 2939855.0,
	 'rongquan_yuliang': 456200.0,
	 'rongzi_changhuan': 873018113.0,
	 'rongzi_mairu': 766987413.0,
	 'rongzi_yue': 7913456484.0,
	 'stock_code': u'600109',
	 'stock_name': u'\u56fd\u91d1\u8bc1\u5238',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 90000.0,
	 'rongquan_maichu': 90000.0,
	 'rongquan_yuliang': 31700.0,
	 'rongzi_changhuan': 168128386.0,
	 'rongzi_mairu': 151329705.0,
	 'rongzi_yue': 1425312816.0,
	 'stock_code': u'600110',
	 'stock_name': u'\u4e2d\u79d1\u82f1\u534e',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 3533699.0,
	 'rongquan_maichu': 3538161.0,
	 'rongquan_yuliang': 406662.0,
	 'rongzi_changhuan': 973654889.0,
	 'rongzi_mairu': 958737228.0,
	 'rongzi_yue': 4682553010.0,
	 'stock_code': u'600111',
	 'stock_name': u'\u5317\u65b9\u7a00\u571f',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 21900.0,
	 'rongzi_changhuan': 134770129.0,
	 'rongzi_mairu': 113442518.0,
	 'rongzi_yue': 2306077659.0,
	 'stock_code': u'600112',
	 'stock_name': u'\u5929\u6210\u63a7\u80a1',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 367100.0,
	 'rongquan_maichu': 366900.0,
	 'rongquan_yuliang': 36334.0,
	 'rongzi_changhuan': 83610824.0,
	 'rongzi_mairu': 96945946.0,
	 'rongzi_yue': 495945139.0,
	 'stock_code': u'600113',
	 'stock_name': u'\u6d59\u6c5f\u4e1c\u65e5',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 697300.0,
	 'rongzi_changhuan': 55581254.0,
	 'rongzi_mairu': 0.0,
	 'rongzi_yue': 1286744554.0,
	 'stock_code': u'600115',
	 'stock_name': u'\u4e1c\u65b9\u822a\u7a7a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 398240.0,
	 'rongquan_maichu': 396840.0,
	 'rongquan_yuliang': 50201.0,
	 'rongzi_changhuan': 110134752.0,
	 'rongzi_mairu': 85875467.0,
	 'rongzi_yue': 559152906.0,
	 'stock_code': u'600116',
	 'stock_name': u'\u4e09\u5ce1\u6c34\u5229',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 1495628.0,
	 'rongquan_maichu': 1500128.0,
	 'rongquan_yuliang': 183646.0,
	 'rongzi_changhuan': 475899158.0,
	 'rongzi_mairu': 474140027.0,
	 'rongzi_yue': 3058891846.0,
	 'stock_code': u'600118',
	 'stock_name': u'\u4e2d\u56fd\u536b\u661f',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 43883.0,
	 'rongquan_maichu': 44283.0,
	 'rongquan_yuliang': 9900.0,
	 'rongzi_changhuan': 73383603.0,
	 'rongzi_mairu': 78766150.0,
	 'rongzi_yue': 795816144.0,
	 'stock_code': u'600119',
	 'stock_name': u'\u957f\u6c5f\u6295\u8d44',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 269100.0,
	 'rongquan_maichu': 269600.0,
	 'rongquan_yuliang': 62521.0,
	 'rongzi_changhuan': 134042247.0,
	 'rongzi_mairu': 107640071.0,
	 'rongzi_yue': 1446563048.0,
	 'stock_code': u'600120',
	 'stock_name': u'\u6d59\u6c5f\u4e1c\u65b9',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 475900.0,
	 'rongquan_maichu': 494200.0,
	 'rongquan_yuliang': 165500.0,
	 'rongzi_changhuan': 192163879.0,
	 'rongzi_mairu': 151080419.0,
	 'rongzi_yue': 1000654408.0,
	 'stock_code': u'600123',
	 'stock_name': u'\u5170\u82b1\u79d1\u521b',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 501920.0,
	 'rongquan_maichu': 511100.0,
	 'rongquan_yuliang': 205280.0,
	 'rongzi_changhuan': 506809667.0,
	 'rongzi_mairu': 458690752.0,
	 'rongzi_yue': 1734860198.0,
	 'stock_code': u'600125',
	 'stock_name': u'\u94c1\u9f99\u7269\u6d41',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 34789.0,
	 'rongquan_maichu': 65489.0,
	 'rongquan_yuliang': 84300.0,
	 'rongzi_changhuan': 85949143.0,
	 'rongzi_mairu': 79484455.0,
	 'rongzi_yue': 765118938.0,
	 'stock_code': u'600132',
	 'stock_name': u'\u91cd\u5e86\u5564\u9152',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 11800.0,
	 'rongzi_changhuan': 89605307.0,
	 'rongzi_mairu': 67796422.0,
	 'rongzi_yue': 692515989.0,
	 'stock_code': u'600135',
	 'stock_name': u'\u4e50\u51ef\u80f6\u7247',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 78399.0,
	 'rongquan_maichu': 94999.0,
	 'rongquan_yuliang': 116001.0,
	 'rongzi_changhuan': 198919675.0,
	 'rongzi_mairu': 194027758.0,
	 'rongzi_yue': 945851519.0,
	 'stock_code': u'600138',
	 'stock_name': u'\u4e2d\u9752\u65c5',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 195900.0,
	 'rongquan_maichu': 190900.0,
	 'rongquan_yuliang': 53200.0,
	 'rongzi_changhuan': 85557123.0,
	 'rongzi_mairu': 77300214.0,
	 'rongzi_yue': 1157226471.0,
	 'stock_code': u'600139',
	 'stock_name': u'\u897f\u90e8\u8d44\u6e90',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 7900.0,
	 'rongquan_maichu': 12300.0,
	 'rongquan_yuliang': 40100.0,
	 'rongzi_changhuan': 81934790.0,
	 'rongzi_mairu': 53752276.0,
	 'rongzi_yue': 678857248.0,
	 'stock_code': u'600141',
	 'stock_name': u'\u5174\u53d1\u96c6\u56e2',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 2773426.0,
	 'rongquan_maichu': 2807926.0,
	 'rongquan_yuliang': 951142.0,
	 'rongzi_changhuan': 197035516.0,
	 'rongzi_mairu': 196779059.0,
	 'rongzi_yue': 1519901388.0,
	 'stock_code': u'600143',
	 'stock_name': u'\u91d1\u53d1\u79d1\u6280',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 1400.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 27100.0,
	 'rongzi_changhuan': 25781827.0,
	 'rongzi_mairu': 18146449.0,
	 'rongzi_yue': 423612841.0,
	 'stock_code': u'600146',
	 'stock_name': u'\u5927\u5143\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 479129.0,
	 'rongquan_maichu': 478529.0,
	 'rongquan_yuliang': 104993.0,
	 'rongzi_changhuan': 95034059.0,
	 'rongzi_mairu': 119633856.0,
	 'rongzi_yue': 854738289.0,
	 'stock_code': u'600149',
	 'stock_name': u'\u5eca\u574a\u53d1\u5c55',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 1465788.0,
	 'rongquan_maichu': 1461270.0,
	 'rongquan_yuliang': 316123.0,
	 'rongzi_changhuan': 1341239081.0,
	 'rongzi_mairu': 1326284436.0,
	 'rongzi_yue': 5016742753.0,
	 'stock_code': u'600150',
	 'stock_name': u'\u4e2d\u56fd\u8239\u8236',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 145800.0,
	 'rongquan_maichu': 147000.0,
	 'rongquan_yuliang': 46300.0,
	 'rongzi_changhuan': 265679748.0,
	 'rongzi_mairu': 209741806.0,
	 'rongzi_yue': 1334656208.0,
	 'stock_code': u'600151',
	 'stock_name': u'\u822a\u5929\u673a\u7535',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 2254089.0,
	 'rongquan_maichu': 2249689.0,
	 'rongquan_yuliang': 554541.0,
	 'rongzi_changhuan': 253061975.0,
	 'rongzi_mairu': 383930129.0,
	 'rongzi_yue': 2184240401.0,
	 'stock_code': u'600153',
	 'stock_name': u'\u5efa\u53d1\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 34600.0,
	 'rongzi_changhuan': 3077131.0,
	 'rongzi_mairu': 0.0,
	 'rongzi_yue': 371699421.0,
	 'stock_code': u'600155',
	 'stock_name': u'\u5b9d\u7855\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 3922412.0,
	 'rongquan_maichu': 3698807.0,
	 'rongquan_yuliang': 406300.0,
	 'rongzi_changhuan': 512110810.0,
	 'rongzi_mairu': 455303654.0,
	 'rongzi_yue': 1082612677.0,
	 'stock_code': u'600157',
	 'stock_name': u'\u6c38\u6cf0\u80fd\u6e90',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 538592.0,
	 'rongquan_maichu': 535750.0,
	 'rongquan_yuliang': 162000.0,
	 'rongzi_changhuan': 172856186.0,
	 'rongzi_mairu': 206375569.0,
	 'rongzi_yue': 2403062242.0,
	 'stock_code': u'600158',
	 'stock_name': u'\u4e2d\u4f53\u4ea7\u4e1a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 1810710.0,
	 'rongquan_maichu': 1795004.0,
	 'rongquan_yuliang': 197794.0,
	 'rongzi_changhuan': 93156596.0,
	 'rongzi_mairu': 81803292.0,
	 'rongzi_yue': 914177285.0,
	 'stock_code': u'600160',
	 'stock_name': u'\u5de8\u5316\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 76565.0,
	 'rongquan_maichu': 77165.0,
	 'rongquan_yuliang': 16200.0,
	 'rongzi_changhuan': 101879809.0,
	 'rongzi_mairu': 76621303.0,
	 'rongzi_yue': 1389951615.0,
	 'stock_code': u'600161',
	 'stock_name': u'\u5929\u575b\u751f\u7269',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 7089067.0,
	 'rongquan_maichu': 7084167.0,
	 'rongquan_yuliang': 750100.0,
	 'rongzi_changhuan': 244378420.0,
	 'rongzi_mairu': 246976314.0,
	 'rongzi_yue': 1801153188.0,
	 'stock_code': u'600166',
	 'stock_name': u'\u798f\u7530\u6c7d\u8f66',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 1575740.0,
	 'rongquan_maichu': 1575200.0,
	 'rongquan_yuliang': 240260.0,
	 'rongzi_changhuan': 710973398.0,
	 'rongzi_mairu': 513054880.0,
	 'rongzi_yue': 2114961896.0,
	 'stock_code': u'600169',
	 'stock_name': u'\u592a\u539f\u91cd\u5de5',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 2067166.0,
	 'rongquan_maichu': 2074765.0,
	 'rongquan_yuliang': 326525.0,
	 'rongzi_changhuan': 254512733.0,
	 'rongzi_mairu': 229101754.0,
	 'rongzi_yue': 1226557883.0,
	 'stock_code': u'600170',
	 'stock_name': u'\u4e0a\u6d77\u5efa\u5de5',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 8500.0,
	 'rongquan_maichu': 22900.0,
	 'rongquan_yuliang': 47700.0,
	 'rongzi_changhuan': 81816657.0,
	 'rongzi_mairu': 65177144.0,
	 'rongzi_yue': 1296231520.0,
	 'stock_code': u'600171',
	 'stock_name': u'\u4e0a\u6d77\u8d1d\u5cad',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 20000.0,
	 'rongquan_maichu': 23200.0,
	 'rongquan_yuliang': 16700.0,
	 'rongzi_changhuan': 147120214.0,
	 'rongzi_mairu': 190588404.0,
	 'rongzi_yue': 1095400320.0,
	 'stock_code': u'600175',
	 'stock_name': u'\u7f8e\u90fd\u80fd\u6e90',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 60100.0,
	 'rongquan_maichu': 60000.0,
	 'rongquan_yuliang': 23200.0,
	 'rongzi_changhuan': 177341363.0,
	 'rongzi_mairu': 199994023.0,
	 'rongzi_yue': 1091646616.0,
	 'stock_code': u'600176',
	 'stock_name': u'\u4e2d\u56fd\u5de8\u77f3',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 2347086.0,
	 'rongquan_maichu': 2341905.0,
	 'rongquan_yuliang': 850232.0,
	 'rongzi_changhuan': 403011455.0,
	 'rongzi_mairu': 431346396.0,
	 'rongzi_yue': 3738984077.0,
	 'stock_code': u'600177',
	 'stock_name': u'\u96c5\u6208\u5c14',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 77500.0,
	 'rongzi_changhuan': 1588330.0,
	 'rongzi_mairu': 0.0,
	 'rongzi_yue': 81411553.0,
	 'stock_code': u'600179',
	 'stock_name': u'\u9ed1\u5316\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 11300.0,
	 'rongzi_changhuan': 88558089.0,
	 'rongzi_mairu': 82916935.0,
	 'rongzi_yue': 1075363927.0,
	 'stock_code': u'600183',
	 'stock_name': u'\u751f\u76ca\u79d1\u6280',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 93300.0,
	 'rongzi_changhuan': 34225304.0,
	 'rongzi_mairu': 0.0,
	 'rongzi_yue': 748470954.0,
	 'stock_code': u'600185',
	 'stock_name': u'\u683c\u529b\u5730\u4ea7',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 15900.0,
	 'rongquan_maichu': 6500.0,
	 'rongquan_yuliang': 86300.0,
	 'rongzi_changhuan': 91628755.0,
	 'rongzi_mairu': 78127056.0,
	 'rongzi_yue': 786071886.0,
	 'stock_code': u'600186',
	 'stock_name': u'\u83b2\u82b1\u5473\u7cbe',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 122100.0,
	 'rongquan_maichu': 120800.0,
	 'rongquan_yuliang': 46900.0,
	 'rongzi_changhuan': 279034118.0,
	 'rongzi_mairu': 234527751.0,
	 'rongzi_yue': 1672000632.0,
	 'stock_code': u'600187',
	 'stock_name': u'\u56fd\u4e2d\u6c34\u52a1',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 1781975.0,
	 'rongquan_maichu': 1782273.0,
	 'rongquan_yuliang': 218607.0,
	 'rongzi_changhuan': 111051832.0,
	 'rongzi_mairu': 105298791.0,
	 'rongzi_yue': 525757986.0,
	 'stock_code': u'600188',
	 'stock_name': u'\u5156\u5dde\u7164\u4e1a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 5300.0,
	 'rongquan_maichu': 1000.0,
	 'rongquan_yuliang': 37700.0,
	 'rongzi_changhuan': 42268483.0,
	 'rongzi_mairu': 56075254.0,
	 'rongzi_yue': 462783798.0,
	 'stock_code': u'600193',
	 'stock_name': u'\u521b\u5174\u8d44\u6e90',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 1439889.0,
	 'rongquan_maichu': 1266768.0,
	 'rongquan_yuliang': 413912.0,
	 'rongzi_changhuan': 285421318.0,
	 'rongzi_mairu': 496765024.0,
	 'rongzi_yue': 1665624967.0,
	 'stock_code': u'600196',
	 'stock_name': u'\u590d\u661f\u533b\u836f',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 38300.0,
	 'rongquan_maichu': 37900.0,
	 'rongquan_yuliang': 19000.0,
	 'rongzi_changhuan': 68834900.0,
	 'rongzi_mairu': 57873300.0,
	 'rongzi_yue': 499140676.0,
	 'stock_code': u'600197',
	 'stock_name': u'\u4f0a\u529b\u7279',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 40100.0,
	 'rongquan_maichu': 38100.0,
	 'rongquan_yuliang': 10100.0,
	 'rongzi_changhuan': 113380488.0,
	 'rongzi_mairu': 126386085.0,
	 'rongzi_yue': 1518076257.0,
	 'stock_code': u'600198',
	 'stock_name': u'\u5927\u5510\u7535\u4fe1',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 268100.0,
	 'rongquan_maichu': 267200.0,
	 'rongquan_yuliang': 23900.0,
	 'rongzi_changhuan': 112245656.0,
	 'rongzi_mairu': 90633931.0,
	 'rongzi_yue': 807091558.0,
	 'stock_code': u'600199',
	 'stock_name': u'\u91d1\u79cd\u5b50\u9152',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 1500.0,
	 'rongquan_maichu': 4700.0,
	 'rongquan_yuliang': 15000.0,
	 'rongzi_changhuan': 184839103.0,
	 'rongzi_mairu': 183758268.0,
	 'rongzi_yue': 1997940684.0,
	 'stock_code': u'600200',
	 'stock_name': u'\u6c5f\u82cf\u5434\u4e2d',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 0.0,
	 'rongzi_changhuan': 36751451.0,
	 'rongzi_mairu': 47655885.0,
	 'rongzi_yue': 1156050618.0,
	 'stock_code': u'600201',
	 'stock_name': u'\u91d1\u5b87\u96c6\u56e2',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 5500.0,
	 'rongquan_maichu': 11400.0,
	 'rongquan_yuliang': 51900.0,
	 'rongzi_changhuan': 158425901.0,
	 'rongzi_mairu': 118617244.0,
	 'rongzi_yue': 1170312107.0,
	 'stock_code': u'600206',
	 'stock_name': u'\u6709\u7814\u65b0\u6750',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 1921218.0,
	 'rongquan_maichu': 1916218.0,
	 'rongquan_yuliang': 726900.0,
	 'rongzi_changhuan': 399335136.0,
	 'rongzi_mairu': 373910960.0,
	 'rongzi_yue': 2277295458.0,
	 'stock_code': u'600208',
	 'stock_name': u'\u65b0\u6e56\u4e2d\u5b9d',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 17000.0,
	 'rongzi_changhuan': 3636750.0,
	 'rongzi_mairu': 0.0,
	 'rongzi_yue': 305890030.0,
	 'stock_code': u'600209',
	 'stock_name': u'\u7f57\u987f\u53d1\u5c55',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 11800.0,
	 'rongzi_changhuan': 79858369.0,
	 'rongzi_mairu': 82957414.0,
	 'rongzi_yue': 783697646.0,
	 'stock_code': u'600210',
	 'stock_name': u'\u7d2b\u6c5f\u4f01\u4e1a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 217273.0,
	 'rongquan_maichu': 204373.0,
	 'rongquan_yuliang': 127900.0,
	 'rongzi_changhuan': 135042255.0,
	 'rongzi_mairu': 109784437.0,
	 'rongzi_yue': 1178902840.0,
	 'stock_code': u'600216',
	 'stock_name': u'\u6d59\u6c5f\u533b\u836f',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 2700.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 46400.0,
	 'rongzi_changhuan': 36777404.0,
	 'rongzi_mairu': 46047910.0,
	 'rongzi_yue': 577456602.0,
	 'stock_code': u'600218',
	 'stock_name': u'\u5168\u67f4\u52a8\u529b',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 1613857.0,
	 'rongquan_maichu': 1614709.0,
	 'rongquan_yuliang': 162200.0,
	 'rongzi_changhuan': 783192010.0,
	 'rongzi_mairu': 700687350.0,
	 'rongzi_yue': 3917355980.0,
	 'stock_code': u'600219',
	 'stock_name': u'\u5357\u5c71\u94dd\u4e1a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 67000.0,
	 'rongquan_maichu': 57000.0,
	 'rongquan_yuliang': 32514.0,
	 'rongzi_changhuan': 115827094.0,
	 'rongzi_mairu': 151696952.0,
	 'rongzi_yue': 1077528725.0,
	 'stock_code': u'600220',
	 'stock_name': u'\u6c5f\u82cf\u9633\u5149',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 12989651.0,
	 'rongquan_maichu': 12502851.0,
	 'rongquan_yuliang': 2425072.0,
	 'rongzi_changhuan': 650889661.0,
	 'rongzi_mairu': 599843859.0,
	 'rongzi_yue': 2279378313.0,
	 'stock_code': u'600221',
	 'stock_name': u'\u6d77\u5357\u822a\u7a7a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 26200.0,
	 'rongquan_maichu': 16100.0,
	 'rongquan_yuliang': 10900.0,
	 'rongzi_changhuan': 52328482.0,
	 'rongzi_mairu': 47862118.0,
	 'rongzi_yue': 602253227.0,
	 'stock_code': u'600222',
	 'stock_name': u'\u592a\u9f99\u836f\u4e1a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 36500.0,
	 'rongquan_maichu': 38700.0,
	 'rongquan_yuliang': 71500.0,
	 'rongzi_changhuan': 65851143.0,
	 'rongzi_mairu': 52331627.0,
	 'rongzi_yue': 470937514.0,
	 'stock_code': u'600223',
	 'stock_name': u'\u9c81\u5546\u7f6e\u4e1a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 11500.0,
	 'rongquan_maichu': 10400.0,
	 'rongquan_yuliang': 36700.0,
	 'rongzi_changhuan': 50090189.0,
	 'rongzi_mairu': 43809441.0,
	 'rongzi_yue': 398746163.0,
	 'stock_code': u'600225',
	 'stock_name': u'\u5929\u6d25\u677e\u6c5f',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 61943.0,
	 'rongquan_maichu': 61943.0,
	 'rongquan_yuliang': 8500.0,
	 'rongzi_changhuan': 69611739.0,
	 'rongzi_mairu': 67065066.0,
	 'rongzi_yue': 560465848.0,
	 'stock_code': u'600229',
	 'stock_name': u'\u9752\u5c9b\u78b1\u4e1a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 1600.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 38700.0,
	 'rongzi_changhuan': 47355446.0,
	 'rongzi_mairu': 56234029.0,
	 'rongzi_yue': 395968371.0,
	 'stock_code': u'600230',
	 'stock_name': u'\u6ca7\u5dde\u5927\u5316',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 0.0,
	 'rongzi_changhuan': 74740256.0,
	 'rongzi_mairu': 99421265.0,
	 'rongzi_yue': 813550996.0,
	 'stock_code': u'600237',
	 'stock_name': u'\u94dc\u5cf0\u7535\u5b50',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 52000.0,
	 'rongquan_maichu': 51600.0,
	 'rongquan_yuliang': 153410.0,
	 'rongzi_changhuan': 91742072.0,
	 'rongzi_mairu': 79562013.0,
	 'rongzi_yue': 1027233321.0,
	 'stock_code': u'600239',
	 'stock_name': u'\u4e91\u5357\u57ce\u6295',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 390379.0,
	 'rongquan_maichu': 390379.0,
	 'rongquan_yuliang': 198928.0,
	 'rongzi_changhuan': 177471661.0,
	 'rongzi_mairu': 220285118.0,
	 'rongzi_yue': 1718465521.0,
	 'stock_code': u'600240',
	 'stock_name': u'\u534e\u4e1a\u5730\u4ea7',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 13000.0,
	 'rongquan_maichu': 14300.0,
	 'rongquan_yuliang': 6300.0,
	 'rongzi_changhuan': 91222992.0,
	 'rongzi_mairu': 75233079.0,
	 'rongzi_yue': 799937642.0,
	 'stock_code': u'600251',
	 'stock_name': u'\u51a0\u519c\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 748917.0,
	 'rongquan_maichu': 677517.0,
	 'rongquan_yuliang': 648157.0,
	 'rongzi_changhuan': 245514068.0,
	 'rongzi_mairu': 193079266.0,
	 'rongzi_yue': 2687475012.0,
	 'stock_code': u'600252',
	 'stock_name': u'\u4e2d\u6052\u96c6\u56e2',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 6478372.0,
	 'rongquan_maichu': 6556048.0,
	 'rongquan_yuliang': 806300.0,
	 'rongzi_changhuan': 849984263.0,
	 'rongzi_mairu': 747841855.0,
	 'rongzi_yue': 4418366486.0,
	 'stock_code': u'600256',
	 'stock_name': u'\u5e7f\u6c47\u80fd\u6e90',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 900.0,
	 'rongquan_yuliang': 39200.0,
	 'rongzi_changhuan': 59427532.0,
	 'rongzi_mairu': 81315448.0,
	 'rongzi_yue': 728883763.0,
	 'stock_code': u'600257',
	 'stock_name': u'\u5927\u6e56\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 251165.0,
	 'rongquan_maichu': 249265.0,
	 'rongquan_yuliang': 61837.0,
	 'rongzi_changhuan': 200167637.0,
	 'rongzi_mairu': 230498514.0,
	 'rongzi_yue': 1099394060.0,
	 'stock_code': u'600259',
	 'stock_name': u'\u5e7f\u665f\u6709\u8272',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 37000.0,
	 'rongzi_changhuan': 23295526.0,
	 'rongzi_mairu': 0.0,
	 'rongzi_yue': 983152192.0,
	 'stock_code': u'600260',
	 'stock_name': u'\u51ef\u4e50\u79d1\u6280',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 34800.0,
	 'rongquan_maichu': 33900.0,
	 'rongquan_yuliang': 15100.0,
	 'rongzi_changhuan': 84207061.0,
	 'rongzi_mairu': 67292811.0,
	 'rongzi_yue': 612598802.0,
	 'stock_code': u'600261',
	 'stock_name': u'\u9633\u5149\u7167\u660e',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 132232.0,
	 'rongquan_maichu': 148032.0,
	 'rongquan_yuliang': 85900.0,
	 'rongzi_changhuan': 257483770.0,
	 'rongzi_mairu': 182111716.0,
	 'rongzi_yue': 2100910015.0,
	 'stock_code': u'600266',
	 'stock_name': u'\u5317\u4eac\u57ce\u5efa',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 167475.0,
	 'rongquan_maichu': 137433.0,
	 'rongquan_yuliang': 340773.0,
	 'rongzi_changhuan': 173053751.0,
	 'rongzi_mairu': 148739635.0,
	 'rongzi_yue': 1642930012.0,
	 'stock_code': u'600267',
	 'stock_name': u'\u6d77\u6b63\u836f\u4e1a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 77500.0,
	 'rongquan_maichu': 76600.0,
	 'rongquan_yuliang': 29500.0,
	 'rongzi_changhuan': 113177877.0,
	 'rongzi_mairu': 86687149.0,
	 'rongzi_yue': 970318250.0,
	 'stock_code': u'600270',
	 'stock_name': u'\u5916\u8fd0\u53d1\u5c55',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 629544.0,
	 'rongquan_maichu': 625044.0,
	 'rongquan_yuliang': 346152.0,
	 'rongzi_changhuan': 210189757.0,
	 'rongzi_mairu': 246305141.0,
	 'rongzi_yue': 2572018818.0,
	 'stock_code': u'600271',
	 'stock_name': u'\u822a\u5929\u4fe1\u606f',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 318962.0,
	 'rongquan_maichu': 320373.0,
	 'rongquan_yuliang': 672467.0,
	 'rongzi_changhuan': 105553403.0,
	 'rongzi_mairu': 117477752.0,
	 'rongzi_yue': 817355845.0,
	 'stock_code': u'600276',
	 'stock_name': u'\u6052\u745e\u533b\u836f',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 303462.0,
	 'rongquan_maichu': 303962.0,
	 'rongquan_yuliang': 140200.0,
	 'rongzi_changhuan': 165568227.0,
	 'rongzi_mairu': 136171863.0,
	 'rongzi_yue': 1337946707.0,
	 'stock_code': u'600277',
	 'stock_name': u'\u4ebf\u5229\u80fd\u6e90',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 13000.0,
	 'rongzi_changhuan': 8132036.0,
	 'rongzi_mairu': 0.0,
	 'rongzi_yue': 309108977.0,
	 'stock_code': u'600285',
	 'stock_name': u'\u7f9a\u9510\u5236\u836f',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 140615.0,
	 'rongquan_maichu': 131915.0,
	 'rongquan_yuliang': 136390.0,
	 'rongzi_changhuan': 203019753.0,
	 'rongzi_mairu': 351505273.0,
	 'rongzi_yue': 1811998243.0,
	 'stock_code': u'600288',
	 'stock_name': u'\u5927\u6052\u79d1\u6280',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 49600.0,
	 'rongquan_maichu': 48600.0,
	 'rongquan_yuliang': 15100.0,
	 'rongzi_changhuan': 226832969.0,
	 'rongzi_mairu': 266299885.0,
	 'rongzi_yue': 1489703718.0,
	 'stock_code': u'600289',
	 'stock_name': u'\u4ebf\u9633\u4fe1\u901a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 4000.0,
	 'rongquan_maichu': 3100.0,
	 'rongquan_yuliang': 13100.0,
	 'rongzi_changhuan': 92593505.0,
	 'rongzi_mairu': 113259520.0,
	 'rongzi_yue': 786933107.0,
	 'stock_code': u'600292',
	 'stock_name': u'\u4e2d\u7535\u8fdc\u8fbe',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 7100.0,
	 'rongzi_changhuan': 1507168.0,
	 'rongzi_mairu': 0.0,
	 'rongzi_yue': 152982557.0,
	 'stock_code': u'600293',
	 'stock_name': u'\u4e09\u5ce1\u65b0\u6750',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 600.0,
	 'rongquan_yuliang': 25200.0,
	 'rongzi_changhuan': 67408618.0,
	 'rongzi_mairu': 57407241.0,
	 'rongzi_yue': 671806735.0,
	 'stock_code': u'600298',
	 'stock_name': u'\u5b89\u742a\u9175\u6bcd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 9900.0,
	 'rongquan_maichu': 7000.0,
	 'rongquan_yuliang': 65800.0,
	 'rongzi_changhuan': 68557949.0,
	 'rongzi_mairu': 62562088.0,
	 'rongzi_yue': 882571443.0,
	 'stock_code': u'600300',
	 'stock_name': u'\u7ef4\u7ef4\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 126000.0,
	 'rongquan_maichu': 126000.0,
	 'rongquan_yuliang': 103500.0,
	 'rongzi_changhuan': 130093119.0,
	 'rongzi_mairu': 237098384.0,
	 'rongzi_yue': 1161117047.0,
	 'stock_code': u'600307',
	 'stock_name': u'\u9152\u94a2\u5b8f\u5174',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 909979.0,
	 'rongquan_maichu': 912868.0,
	 'rongquan_yuliang': 503262.0,
	 'rongzi_changhuan': 248314014.0,
	 'rongzi_mairu': 221536078.0,
	 'rongzi_yue': 2278333460.0,
	 'stock_code': u'600309',
	 'stock_name': u'\u4e07\u534e\u5316\u5b66',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 198600.0,
	 'rongquan_maichu': 195800.0,
	 'rongquan_yuliang': 54400.0,
	 'rongzi_changhuan': 84141800.0,
	 'rongzi_mairu': 83703201.0,
	 'rongzi_yue': 676330604.0,
	 'stock_code': u'600311',
	 'stock_name': u'\u8363\u534e\u5b9e\u4e1a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 221300.0,
	 'rongquan_maichu': 218700.0,
	 'rongquan_yuliang': 60747.0,
	 'rongzi_changhuan': 204173796.0,
	 'rongzi_mairu': 234114569.0,
	 'rongzi_yue': 1710873809.0,
	 'stock_code': u'600312',
	 'stock_name': u'\u5e73\u9ad8\u7535\u6c14',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 234073.0,
	 'rongquan_maichu': 280046.0,
	 'rongquan_yuliang': 265856.0,
	 'rongzi_changhuan': 173308707.0,
	 'rongzi_mairu': 92523589.0,
	 'rongzi_yue': 1569045840.0,
	 'stock_code': u'600315',
	 'stock_name': u'\u4e0a\u6d77\u5bb6\u5316',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 1036983.0,
	 'rongquan_maichu': 1035528.0,
	 'rongquan_yuliang': 143845.0,
	 'rongzi_changhuan': 357103691.0,
	 'rongzi_mairu': 409422691.0,
	 'rongzi_yue': 2176985247.0,
	 'stock_code': u'600316',
	 'stock_name': u'\u6d2a\u90fd\u822a\u7a7a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 11200.0,
	 'rongquan_maichu': 9600.0,
	 'rongquan_yuliang': 3300.0,
	 'rongzi_changhuan': 69503406.0,
	 'rongzi_mairu': 68288336.0,
	 'rongzi_yue': 698689541.0,
	 'stock_code': u'600318',
	 'stock_name': u'\u5de2\u4e1c\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 572200.0,
	 'rongquan_maichu': 572200.0,
	 'rongquan_yuliang': 18800.0,
	 'rongzi_changhuan': 406324410.0,
	 'rongzi_mairu': 362159827.0,
	 'rongzi_yue': 1124444461.0,
	 'stock_code': u'600320',
	 'stock_name': u'\u632f\u534e\u91cd\u5de5',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 14300.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 32300.0,
	 'rongzi_changhuan': 120222326.0,
	 'rongzi_mairu': 140535743.0,
	 'rongzi_yue': 882717528.0,
	 'stock_code': u'600321',
	 'stock_name': u'\u56fd\u680b\u5efa\u8bbe',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 25100.0,
	 'rongzi_changhuan': 70720232.0,
	 'rongzi_mairu': 93454821.0,
	 'rongzi_yue': 608871556.0,
	 'stock_code': u'600323',
	 'stock_name': u'\u701a\u84dd\u73af\u5883',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 58200.0,
	 'rongquan_maichu': 54100.0,
	 'rongquan_yuliang': 107300.0,
	 'rongzi_changhuan': 206648046.0,
	 'rongzi_mairu': 166852712.0,
	 'rongzi_yue': 1451451445.0,
	 'stock_code': u'600325',
	 'stock_name': u'\u534e\u53d1\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 9200.0,
	 'rongquan_maichu': 8600.0,
	 'rongquan_yuliang': 20900.0,
	 'rongzi_changhuan': 86176056.0,
	 'rongzi_mairu': 56978151.0,
	 'rongzi_yue': 581466079.0,
	 'stock_code': u'600329',
	 'stock_name': u'\u4e2d\u65b0\u836f\u4e1a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 713.0,
	 'rongzi_changhuan': 135682627.0,
	 'rongzi_mairu': 152414048.0,
	 'rongzi_yue': 1273635846.0,
	 'stock_code': u'600330',
	 'stock_name': u'\u5929\u901a\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 2600.0,
	 'rongquan_yuliang': 18900.0,
	 'rongzi_changhuan': 124482394.0,
	 'rongzi_mairu': 97223373.0,
	 'rongzi_yue': 750917898.0,
	 'stock_code': u'600331',
	 'stock_name': u'\u5b8f\u8fbe\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 320630.0,
	 'rongquan_maichu': 327230.0,
	 'rongquan_yuliang': 240577.0,
	 'rongzi_changhuan': 272861514.0,
	 'rongzi_mairu': 212198125.0,
	 'rongzi_yue': 2041612250.0,
	 'stock_code': u'600332',
	 'stock_name': u'\u767d\u4e91\u5c71',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 14100.0,
	 'rongquan_maichu': 14300.0,
	 'rongquan_yuliang': 52000.0,
	 'rongzi_changhuan': 101822782.0,
	 'rongzi_mairu': 39341158.0,
	 'rongzi_yue': 358408129.0,
	 'stock_code': u'600333',
	 'stock_name': u'\u957f\u6625\u71c3\u6c14',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 52700.0,
	 'rongquan_maichu': 43700.0,
	 'rongquan_yuliang': 25198.0,
	 'rongzi_changhuan': 35491137.0,
	 'rongzi_mairu': 32506419.0,
	 'rongzi_yue': 299160007.0,
	 'stock_code': u'600335',
	 'stock_name': u'\u56fd\u673a\u6c7d\u8f66',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 36200.0,
	 'rongquan_maichu': 19100.0,
	 'rongquan_yuliang': 52200.0,
	 'rongzi_changhuan': 85690282.0,
	 'rongzi_mairu': 55536457.0,
	 'rongzi_yue': 562451584.0,
	 'stock_code': u'600336',
	 'stock_name': u'\u6fb3\u67ef\u739b',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 451665.0,
	 'rongquan_maichu': 443448.0,
	 'rongquan_yuliang': 358335.0,
	 'rongzi_changhuan': 150517567.0,
	 'rongzi_mairu': 154957049.0,
	 'rongzi_yue': 1839517126.0,
	 'stock_code': u'600340',
	 'stock_name': u'\u534e\u590f\u5e78\u798f',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 90900.0,
	 'rongquan_maichu': 90900.0,
	 'rongquan_yuliang': 10000.0,
	 'rongzi_changhuan': 697982141.0,
	 'rongzi_mairu': 376047004.0,
	 'rongzi_yue': 1223367433.0,
	 'stock_code': u'600343',
	 'stock_name': u'\u822a\u5929\u52a8\u529b',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 2060382.0,
	 'rongquan_maichu': 2060182.0,
	 'rongquan_yuliang': 262144.0,
	 'rongzi_changhuan': 181061758.0,
	 'rongzi_mairu': 195174514.0,
	 'rongzi_yue': 765187647.0,
	 'stock_code': u'600348',
	 'stock_name': u'\u9633\u6cc9\u7164\u4e1a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 354400.0,
	 'rongquan_maichu': 342000.0,
	 'rongquan_yuliang': 94600.0,
	 'rongzi_changhuan': 68737674.0,
	 'rongzi_mairu': 43636619.0,
	 'rongzi_yue': 446104286.0,
	 'stock_code': u'600350',
	 'stock_name': u'\u5c71\u4e1c\u9ad8\u901f',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 816412.0,
	 'rongquan_maichu': 826412.0,
	 'rongquan_yuliang': 384777.0,
	 'rongzi_changhuan': 495913185.0,
	 'rongzi_mairu': 438362712.0,
	 'rongzi_yue': 6219240641.0,
	 'stock_code': u'600352',
	 'stock_name': u'\u6d59\u6c5f\u9f99\u76db',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 164100.0,
	 'rongquan_maichu': 165300.0,
	 'rongquan_yuliang': 12400.0,
	 'rongzi_changhuan': 88872789.0,
	 'rongzi_mairu': 110520155.0,
	 'rongzi_yue': 540626345.0,
	 'stock_code': u'600354',
	 'stock_name': u'\u6566\u714c\u79cd\u4e1a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 8992720.0,
	 'rongquan_maichu': 8920620.0,
	 'rongquan_yuliang': 1118126.0,
	 'rongzi_changhuan': 408031794.0,
	 'rongzi_mairu': 494969440.0,
	 'rongzi_yue': 1988134953.0,
	 'stock_code': u'600362',
	 'stock_name': u'\u6c5f\u897f\u94dc\u4e1a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 700.0,
	 'rongzi_changhuan': 9053655.0,
	 'rongzi_mairu': 0.0,
	 'rongzi_yue': 608158246.0,
	 'stock_code': u'600363',
	 'stock_name': u'\u8054\u521b\u5149\u7535',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 191227.0,
	 'rongquan_maichu': 188127.0,
	 'rongquan_yuliang': 73747.0,
	 'rongzi_changhuan': 131746691.0,
	 'rongzi_mairu': 156012884.0,
	 'rongzi_yue': 1081519721.0,
	 'stock_code': u'600366',
	 'stock_name': u'\u5b81\u6ce2\u97f5\u5347',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 2313776.0,
	 'rongquan_maichu': 2315884.0,
	 'rongquan_yuliang': 535253.0,
	 'rongzi_changhuan': 511629799.0,
	 'rongzi_mairu': 398666072.0,
	 'rongzi_yue': 4054816377.0,
	 'stock_code': u'600369',
	 'stock_name': u'\u897f\u5357\u8bc1\u5238',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 778350.0,
	 'rongquan_maichu': 809150.0,
	 'rongquan_yuliang': 162343.0,
	 'rongzi_changhuan': 442364475.0,
	 'rongzi_mairu': 492764938.0,
	 'rongzi_yue': 2357296235.0,
	 'stock_code': u'600372',
	 'stock_name': u'\u4e2d\u822a\u7535\u5b50',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 529649.0,
	 'rongquan_maichu': 532407.0,
	 'rongquan_yuliang': 43700.0,
	 'rongzi_changhuan': 79546971.0,
	 'rongzi_mairu': 86716020.0,
	 'rongzi_yue': 941847986.0,
	 'stock_code': u'600373',
	 'stock_name': u'\u4e2d\u6587\u4f20\u5a92',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 4800.0,
	 'rongquan_maichu': 9400.0,
	 'rongquan_yuliang': 40300.0,
	 'rongzi_changhuan': 84552180.0,
	 'rongzi_mairu': 99372693.0,
	 'rongzi_yue': 1023481425.0,
	 'stock_code': u'600375',
	 'stock_name': u'\u534e\u83f1\u661f\u9a6c',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 1039887.0,
	 'rongquan_maichu': 1038108.0,
	 'rongquan_yuliang': 263550.0,
	 'rongzi_changhuan': 338505408.0,
	 'rongzi_mairu': 290856830.0,
	 'rongzi_yue': 1791976954.0,
	 'stock_code': u'600376',
	 'stock_name': u'\u9996\u5f00\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 27700.0,
	 'rongquan_maichu': 25300.0,
	 'rongquan_yuliang': 69100.0,
	 'rongzi_changhuan': 47440363.0,
	 'rongzi_mairu': 38711019.0,
	 'rongzi_yue': 223145415.0,
	 'stock_code': u'600377',
	 'stock_name': u'\u5b81\u6caa\u9ad8\u901f',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 64156.0,
	 'rongquan_maichu': 63456.0,
	 'rongquan_yuliang': 52980.0,
	 'rongzi_changhuan': 447864149.0,
	 'rongzi_mairu': 339646953.0,
	 'rongzi_yue': 1468907353.0,
	 'stock_code': u'600380',
	 'stock_name': u'\u5065\u5eb7\u5143',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 8900.0,
	 'rongzi_changhuan': 20780721.0,
	 'rongzi_mairu': 0.0,
	 'rongzi_yue': 525345225.0,
	 'stock_code': u'600382',
	 'stock_name': u'\u5e7f\u4e1c\u660e\u73e0',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 6271029.0,
	 'rongquan_maichu': 6247029.0,
	 'rongquan_yuliang': 2205945.0,
	 'rongzi_changhuan': 387500495.0,
	 'rongzi_mairu': 377184175.0,
	 'rongzi_yue': 2382993738.0,
	 'stock_code': u'600383',
	 'stock_name': u'\u91d1\u5730\u96c6\u56e2',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 16300.0,
	 'rongquan_maichu': 14000.0,
	 'rongquan_yuliang': 1000.0,
	 'rongzi_changhuan': 39928135.0,
	 'rongzi_mairu': 30431226.0,
	 'rongzi_yue': 449451770.0,
	 'stock_code': u'600386',
	 'stock_name': u'\u5317\u5df4\u4f20\u5a92',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 12900.0,
	 'rongquan_maichu': 12900.0,
	 'rongquan_yuliang': 6100.0,
	 'rongzi_changhuan': 125988989.0,
	 'rongzi_mairu': 129238138.0,
	 'rongzi_yue': 980802857.0,
	 'stock_code': u'600387',
	 'stock_name': u'\u6d77\u8d8a\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 220600.0,
	 'rongquan_maichu': 217300.0,
	 'rongquan_yuliang': 14800.0,
	 'rongzi_changhuan': 362916804.0,
	 'rongzi_mairu': 498165542.0,
	 'rongzi_yue': 1664660221.0,
	 'stock_code': u'600388',
	 'stock_name': u'\u9f99\u51c0\u73af\u4fdd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 300.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 24000.0,
	 'rongzi_changhuan': 31566425.0,
	 'rongzi_mairu': 28083187.0,
	 'rongzi_yue': 322009692.0,
	 'stock_code': u'600389',
	 'stock_name': u'\u6c5f\u5c71\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 211900.0,
	 'rongquan_maichu': 208900.0,
	 'rongquan_yuliang': 1400.0,
	 'rongzi_changhuan': 163129778.0,
	 'rongzi_mairu': 157129149.0,
	 'rongzi_yue': 841743401.0,
	 'stock_code': u'600390',
	 'stock_name': u'\u91d1\u745e\u79d1\u6280',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 117200.0,
	 'rongquan_maichu': 117200.0,
	 'rongquan_yuliang': 6.0,
	 'rongzi_changhuan': 249518792.0,
	 'rongzi_mairu': 266392808.0,
	 'rongzi_yue': 1191981891.0,
	 'stock_code': u'600391',
	 'stock_name': u'\u6210\u53d1\u79d1\u6280',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 121200.0,
	 'rongquan_maichu': 121200.0,
	 'rongquan_yuliang': 700.0,
	 'rongzi_changhuan': 175880320.0,
	 'rongzi_mairu': 176371136.0,
	 'rongzi_yue': 855679475.0,
	 'stock_code': u'600392',
	 'stock_name': u'\u76db\u548c\u8d44\u6e90',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 1778112.0,
	 'rongquan_maichu': 1776874.0,
	 'rongquan_yuliang': 133196.0,
	 'rongzi_changhuan': 140155486.0,
	 'rongzi_mairu': 98286096.0,
	 'rongzi_yue': 679952912.0,
	 'stock_code': u'600395',
	 'stock_name': u'\u76d8\u6c5f\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 3183235.0,
	 'rongquan_maichu': 3192081.0,
	 'rongquan_yuliang': 362219.0,
	 'rongzi_changhuan': 535339058.0,
	 'rongzi_mairu': 503058495.0,
	 'rongzi_yue': 4112036551.0,
	 'stock_code': u'600406',
	 'stock_name': u'\u56fd\u7535\u5357\u745e',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 22000.0,
	 'rongquan_yuliang': 64800.0,
	 'rongzi_changhuan': 81878747.0,
	 'rongzi_mairu': 74862330.0,
	 'rongzi_yue': 434668758.0,
	 'stock_code': u'600408',
	 'stock_name': u'\u5b89\u6cf0\u96c6\u56e2',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 22500.0,
	 'rongquan_maichu': 26300.0,
	 'rongquan_yuliang': 17688.0,
	 'rongzi_changhuan': 141116505.0,
	 'rongzi_mairu': 186894008.0,
	 'rongzi_yue': 1531584811.0,
	 'stock_code': u'600409',
	 'stock_name': u'\u4e09\u53cb\u5316\u5de5',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 107299.0,
	 'rongquan_maichu': 107299.0,
	 'rongquan_yuliang': 14100.0,
	 'rongzi_changhuan': 313748106.0,
	 'rongzi_mairu': 814554616.0,
	 'rongzi_yue': 3441607393.0,
	 'stock_code': u'600410',
	 'stock_name': u'\u534e\u80dc\u5929\u6210',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 1204931.0,
	 'rongquan_maichu': 1203731.0,
	 'rongquan_yuliang': 609919.0,
	 'rongzi_changhuan': 251639732.0,
	 'rongzi_mairu': 223140940.0,
	 'rongzi_yue': 2782632360.0,
	 'stock_code': u'600415',
	 'stock_name': u'\u5c0f\u5546\u54c1\u57ce',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 27100.0,
	 'rongquan_maichu': 27600.0,
	 'rongquan_yuliang': 29900.0,
	 'rongzi_changhuan': 54599951.0,
	 'rongzi_mairu': 52458967.0,
	 'rongzi_yue': 865759007.0,
	 'stock_code': u'600416',
	 'stock_name': u'\u6e58\u7535\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 743060.0,
	 'rongquan_maichu': 755760.0,
	 'rongquan_yuliang': 115582.0,
	 'rongzi_changhuan': 114570453.0,
	 'rongzi_mairu': 100728870.0,
	 'rongzi_yue': 1404267900.0,
	 'stock_code': u'600418',
	 'stock_name': u'\u6c5f\u6dee\u6c7d\u8f66',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 16300.0,
	 'rongquan_maichu': 16200.0,
	 'rongquan_yuliang': 18700.0,
	 'rongzi_changhuan': 67171930.0,
	 'rongzi_mairu': 60921620.0,
	 'rongzi_yue': 672393257.0,
	 'stock_code': u'600422',
	 'stock_name': u'\u6606\u836f\u96c6\u56e2',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 94000.0,
	 'rongquan_maichu': 97800.0,
	 'rongquan_yuliang': 43400.0,
	 'rongzi_changhuan': 140124688.0,
	 'rongzi_mairu': 134090690.0,
	 'rongzi_yue': 643917439.0,
	 'stock_code': u'600425',
	 'stock_name': u'\u9752\u677e\u5efa\u5316',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 57500.0,
	 'rongquan_maichu': 56500.0,
	 'rongquan_yuliang': 61926.0,
	 'rongzi_changhuan': 142713506.0,
	 'rongzi_mairu': 132303366.0,
	 'rongzi_yue': 1206127652.0,
	 'stock_code': u'600426',
	 'stock_name': u'\u534e\u9c81\u6052\u5347',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 95000.0,
	 'rongquan_maichu': 95000.0,
	 'rongquan_yuliang': 18900.0,
	 'rongzi_changhuan': 209831425.0,
	 'rongzi_mairu': 207369648.0,
	 'rongzi_yue': 984481897.0,
	 'stock_code': u'600432',
	 'stock_name': u'\u5409\u6069\u954d\u4e1a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 13400.0,
	 'rongquan_maichu': 13400.0,
	 'rongquan_yuliang': 5000.0,
	 'rongzi_changhuan': 116441343.0,
	 'rongzi_mairu': 94303933.0,
	 'rongzi_yue': 1975738931.0,
	 'stock_code': u'600433',
	 'stock_name': u'\u51a0\u8c6a\u9ad8\u65b0',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 561199.0,
	 'rongquan_maichu': 557199.0,
	 'rongquan_yuliang': 44200.0,
	 'rongzi_changhuan': 176237677.0,
	 'rongzi_mairu': 153010468.0,
	 'rongzi_yue': 2283450301.0,
	 'stock_code': u'600435',
	 'stock_name': u'\u5317\u65b9\u5bfc\u822a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 43941.0,
	 'rongquan_maichu': 39099.0,
	 'rongquan_yuliang': 41949.0,
	 'rongzi_changhuan': 125079709.0,
	 'rongzi_mairu': 170113639.0,
	 'rongzi_yue': 802348167.0,
	 'stock_code': u'600436',
	 'stock_name': u'\u7247\u4ed4\u7640',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 107257.0,
	 'rongquan_maichu': 107257.0,
	 'rongquan_yuliang': 6700.0,
	 'rongzi_changhuan': 109981050.0,
	 'rongzi_mairu': 131724402.0,
	 'rongzi_yue': 1272492423.0,
	 'stock_code': u'600446',
	 'stock_name': u'\u91d1\u8bc1\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 1500.0,
	 'rongquan_maichu': 6800.0,
	 'rongquan_yuliang': 15600.0,
	 'rongzi_changhuan': 79989750.0,
	 'rongzi_mairu': 82778667.0,
	 'rongzi_yue': 557090197.0,
	 'stock_code': u'600449',
	 'stock_name': u'\u5b81\u590f\u5efa\u6750',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 9200.0,
	 'rongquan_maichu': 7100.0,
	 'rongquan_yuliang': 45800.0,
	 'rongzi_changhuan': 136215320.0,
	 'rongzi_mairu': 117659554.0,
	 'rongzi_yue': 720166756.0,
	 'stock_code': u'600456',
	 'stock_name': u'\u5b9d\u949b\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 109890.0,
	 'rongquan_maichu': 109890.0,
	 'rongquan_yuliang': 33500.0,
	 'rongzi_changhuan': 245551386.0,
	 'rongzi_mairu': 233286117.0,
	 'rongzi_yue': 1361105861.0,
	 'stock_code': u'600458',
	 'stock_name': u'\u65f6\u4ee3\u65b0\u6750',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 21800.0,
	 'rongzi_changhuan': 92763062.0,
	 'rongzi_mairu': 57258287.0,
	 'rongzi_yue': 590769485.0,
	 'stock_code': u'600459',
	 'stock_name': u'\u8d35\u7814\u94c2\u4e1a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 116522.0,
	 'rongquan_maichu': 116522.0,
	 'rongquan_yuliang': 54439.0,
	 'rongzi_changhuan': 76782646.0,
	 'rongzi_mairu': 66498002.0,
	 'rongzi_yue': 969180554.0,
	 'stock_code': u'600460',
	 'stock_name': u'\u58eb\u5170\u5fae',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 1100.0,
	 'rongquan_maichu': 400.0,
	 'rongquan_yuliang': 57047.0,
	 'rongzi_changhuan': 55237031.0,
	 'rongzi_mairu': 79082732.0,
	 'rongzi_yue': 518776988.0,
	 'stock_code': u'600467',
	 'stock_name': u'\u597d\u5f53\u5bb6',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 192540.0,
	 'rongquan_maichu': 180840.0,
	 'rongquan_yuliang': 73301.0,
	 'rongzi_changhuan': 74517780.0,
	 'rongzi_mairu': 87429988.0,
	 'rongzi_yue': 645906257.0,
	 'stock_code': u'600470',
	 'stock_name': u'\u516d\u56fd\u5316\u5de5',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 9200.0,
	 'rongquan_maichu': 11200.0,
	 'rongquan_yuliang': 47500.0,
	 'rongzi_changhuan': 103040722.0,
	 'rongzi_mairu': 115236496.0,
	 'rongzi_yue': 1273662704.0,
	 'stock_code': u'600478',
	 'stock_name': u'\u79d1\u529b\u8fdc',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 28000.0,
	 'rongquan_maichu': 28000.0,
	 'rongquan_yuliang': 57342.0,
	 'rongzi_changhuan': 113837740.0,
	 'rongzi_mairu': 139797256.0,
	 'rongzi_yue': 741143438.0,
	 'stock_code': u'600481',
	 'stock_name': u'\u53cc\u826f\u8282\u80fd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 267100.0,
	 'rongquan_maichu': 272400.0,
	 'rongquan_yuliang': 27400.0,
	 'rongzi_changhuan': 179556570.0,
	 'rongzi_mairu': 148985973.0,
	 'rongzi_yue': 1159517084.0,
	 'stock_code': u'600482',
	 'stock_name': u'\u98ce\u5e06\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 54285.0,
	 'rongzi_changhuan': 7497687.0,
	 'rongzi_mairu': 0.0,
	 'rongzi_yue': 123743835.0,
	 'stock_code': u'600483',
	 'stock_name': u'\u798f\u80fd\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 400.0,
	 'rongquan_maichu': 1400.0,
	 'rongquan_yuliang': 1400.0,
	 'rongzi_changhuan': 37776062.0,
	 'rongzi_mairu': 36696225.0,
	 'rongzi_yue': 539850987.0,
	 'stock_code': u'600486',
	 'stock_name': u'\u626c\u519c\u5316\u5de5',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 2889129.0,
	 'rongquan_maichu': 2814023.0,
	 'rongquan_yuliang': 393400.0,
	 'rongzi_changhuan': 560901658.0,
	 'rongzi_mairu': 466548935.0,
	 'rongzi_yue': 2083744986.0,
	 'stock_code': u'600489',
	 'stock_name': u'\u4e2d\u91d1\u9ec4\u91d1',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 179200.0,
	 'rongquan_maichu': 168800.0,
	 'rongquan_yuliang': 71800.0,
	 'rongzi_changhuan': 334797174.0,
	 'rongzi_mairu': 208331513.0,
	 'rongzi_yue': 2632577283.0,
	 'stock_code': u'600490',
	 'stock_name': u'\u9e4f\u6b23\u8d44\u6e90',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 326300.0,
	 'rongquan_maichu': 319600.0,
	 'rongquan_yuliang': 90900.0,
	 'rongzi_changhuan': 147454680.0,
	 'rongzi_mairu': 182917282.0,
	 'rongzi_yue': 1088648868.0,
	 'stock_code': u'600491',
	 'stock_name': u'\u9f99\u5143\u5efa\u8bbe',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 866249.0,
	 'rongquan_maichu': 870649.0,
	 'rongquan_yuliang': 33201.0,
	 'rongzi_changhuan': 336821989.0,
	 'rongzi_mairu': 314064591.0,
	 'rongzi_yue': 1771949223.0,
	 'stock_code': u'600495',
	 'stock_name': u'\u664b\u897f\u8f66\u8f74',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 1445744.0,
	 'rongquan_maichu': 1451311.0,
	 'rongquan_yuliang': 105673.0,
	 'rongzi_changhuan': 276869950.0,
	 'rongzi_mairu': 291814047.0,
	 'rongzi_yue': 1187224334.0,
	 'stock_code': u'600497',
	 'stock_name': u'\u9a70\u5b8f\u950c\u9517',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 824078.0,
	 'rongquan_maichu': 818278.0,
	 'rongquan_yuliang': 145500.0,
	 'rongzi_changhuan': 124041241.0,
	 'rongzi_mairu': 145227650.0,
	 'rongzi_yue': 1196827786.0,
	 'stock_code': u'600498',
	 'stock_name': u'\u70fd\u706b\u901a\u4fe1',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 13500.0,
	 'rongquan_maichu': 4900.0,
	 'rongquan_yuliang': 12800.0,
	 'rongzi_changhuan': 127922927.0,
	 'rongzi_mairu': 140174657.0,
	 'rongzi_yue': 1972347382.0,
	 'stock_code': u'600499',
	 'stock_name': u'\u79d1\u8fbe\u6d01\u80fd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 166800.0,
	 'rongquan_maichu': 170100.0,
	 'rongquan_yuliang': 6300.0,
	 'rongzi_changhuan': 263026954.0,
	 'rongzi_mairu': 265997940.0,
	 'rongzi_yue': 1473760435.0,
	 'stock_code': u'600500',
	 'stock_name': u'\u4e2d\u5316\u56fd\u9645',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 285392.0,
	 'rongquan_maichu': 279392.0,
	 'rongquan_yuliang': 38140.0,
	 'rongzi_changhuan': 170036384.0,
	 'rongzi_mairu': 166981871.0,
	 'rongzi_yue': 767182774.0,
	 'stock_code': u'600502',
	 'stock_name': u'\u5b89\u5fbd\u6c34\u5229',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 45300.0,
	 'rongzi_changhuan': 2613663.0,
	 'rongzi_mairu': 0.0,
	 'rongzi_yue': 486794355.0,
	 'stock_code': u'600503',
	 'stock_name': u'\u534e\u4e3d\u5bb6\u65cf',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 40000.0,
	 'rongquan_maichu': 42000.0,
	 'rongquan_yuliang': 12900.0,
	 'rongzi_changhuan': 170791842.0,
	 'rongzi_mairu': 175497810.0,
	 'rongzi_yue': 959348045.0,
	 'stock_code': u'600509',
	 'stock_name': u'\u5929\u5bcc\u80fd\u6e90',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 132300.0,
	 'rongquan_maichu': 131800.0,
	 'rongquan_yuliang': 28032.0,
	 'rongzi_changhuan': 63600242.0,
	 'rongzi_mairu': 41865608.0,
	 'rongzi_yue': 535959219.0,
	 'stock_code': u'600515',
	 'stock_name': u'\u6d77\u5c9b\u5efa\u8bbe',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 139587.0,
	 'rongzi_changhuan': 45038777.0,
	 'rongzi_mairu': 0.0,
	 'rongzi_yue': 1491406530.0,
	 'stock_code': u'600516',
	 'stock_name': u'\u65b9\u5927\u70ad\u7d20',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 23660.0,
	 'rongquan_maichu': 23700.0,
	 'rongquan_yuliang': 38975.0,
	 'rongzi_changhuan': 167534498.0,
	 'rongzi_mairu': 109756765.0,
	 'rongzi_yue': 1165985171.0,
	 'stock_code': u'600517',
	 'stock_name': u'\u7f6e\u4fe1\u7535\u6c14',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 2563860.0,
	 'rongquan_maichu': 2563560.0,
	 'rongquan_yuliang': 725233.0,
	 'rongzi_changhuan': 707859802.0,
	 'rongzi_mairu': 682524461.0,
	 'rongzi_yue': 6767982021.0,
	 'stock_code': u'600518',
	 'stock_name': u'\u5eb7\u7f8e\u836f\u4e1a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 261079.0,
	 'rongquan_maichu': 262779.0,
	 'rongquan_yuliang': 504550.0,
	 'rongzi_changhuan': 362246020.0,
	 'rongzi_mairu': 508492177.0,
	 'rongzi_yue': 3536860887.0,
	 'stock_code': u'600519',
	 'stock_name': u'\u8d35\u5dde\u8305\u53f0',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 26318.0,
	 'rongquan_maichu': 26300.0,
	 'rongquan_yuliang': 29344.0,
	 'rongzi_changhuan': 55207598.0,
	 'rongzi_mairu': 64401921.0,
	 'rongzi_yue': 577983230.0,
	 'stock_code': u'600521',
	 'stock_name': u'\u534e\u6d77\u836f\u4e1a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 36200.0,
	 'rongzi_changhuan': 13064585.0,
	 'rongzi_mairu': 0.0,
	 'rongzi_yue': 912353658.0,
	 'stock_code': u'600522',
	 'stock_name': u'\u4e2d\u5929\u79d1\u6280',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 63900.0,
	 'rongquan_maichu': 63900.0,
	 'rongquan_yuliang': 0.0,
	 'rongzi_changhuan': 67004410.0,
	 'rongzi_mairu': 57678233.0,
	 'rongzi_yue': 452856809.0,
	 'stock_code': u'600523',
	 'stock_name': u'\u8d35\u822a\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 200.0,
	 'rongquan_maichu': 100.0,
	 'rongquan_yuliang': 2344.0,
	 'rongzi_changhuan': 42694651.0,
	 'rongzi_mairu': 44351316.0,
	 'rongzi_yue': 634967559.0,
	 'stock_code': u'600525',
	 'stock_name': u'\u957f\u56ed\u96c6\u56e2',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 31600.0,
	 'rongquan_maichu': 30000.0,
	 'rongquan_yuliang': 8000.0,
	 'rongzi_changhuan': 188420956.0,
	 'rongzi_mairu': 142186877.0,
	 'rongzi_yue': 991652843.0,
	 'stock_code': u'600526',
	 'stock_name': u'\u83f2\u8fbe\u73af\u4fdd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 826139.0,
	 'rongquan_maichu': 827148.0,
	 'rongquan_yuliang': 333209.0,
	 'rongzi_changhuan': 876884953.0,
	 'rongzi_mairu': 890512877.0,
	 'rongzi_yue': 2714494654.0,
	 'stock_code': u'600528',
	 'stock_name': u'\u4e2d\u94c1\u4e8c\u5c40',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 372492.0,
	 'rongquan_maichu': 395472.0,
	 'rongquan_yuliang': 389959.0,
	 'rongzi_changhuan': 153934520.0,
	 'rongzi_mairu': 152401700.0,
	 'rongzi_yue': 1556092327.0,
	 'stock_code': u'600535',
	 'stock_name': u'\u5929\u58eb\u529b',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 34400.0,
	 'rongquan_maichu': 34400.0,
	 'rongquan_yuliang': 0.0,
	 'rongzi_changhuan': 195844833.0,
	 'rongzi_mairu': 360761508.0,
	 'rongzi_yue': 2055742983.0,
	 'stock_code': u'600536',
	 'stock_name': u'\u4e2d\u56fd\u8f6f\u4ef6',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 143693.0,
	 'rongquan_maichu': 135393.0,
	 'rongquan_yuliang': 36344.0,
	 'rongzi_changhuan': 121810316.0,
	 'rongzi_mairu': 138942428.0,
	 'rongzi_yue': 1056420628.0,
	 'stock_code': u'600537',
	 'stock_name': u'\u4ebf\u6676\u5149\u7535',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 43500.0,
	 'rongquan_maichu': 43900.0,
	 'rongquan_yuliang': 99500.0,
	 'rongzi_changhuan': 34264711.0,
	 'rongzi_mairu': 46471854.0,
	 'rongzi_yue': 481497124.0,
	 'stock_code': u'600543',
	 'stock_name': u'\u83ab\u9ad8\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 914078.0,
	 'rongquan_maichu': 914578.0,
	 'rongquan_yuliang': 13300.0,
	 'rongzi_changhuan': 531994673.0,
	 'rongzi_mairu': 447873662.0,
	 'rongzi_yue': 1650098789.0,
	 'stock_code': u'600545',
	 'stock_name': u'\u65b0\u7586\u57ce\u5efa',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 877800.0,
	 'rongquan_maichu': 876700.0,
	 'rongquan_yuliang': 178719.0,
	 'rongzi_changhuan': 95279641.0,
	 'rongzi_mairu': 108833740.0,
	 'rongzi_yue': 675935481.0,
	 'stock_code': u'600546',
	 'stock_name': u'\u5c71\u7164\u56fd\u9645',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 1188870.0,
	 'rongquan_maichu': 1180630.0,
	 'rongquan_yuliang': 232754.0,
	 'rongzi_changhuan': 394517628.0,
	 'rongzi_mairu': 550335410.0,
	 'rongzi_yue': 2266869207.0,
	 'stock_code': u'600547',
	 'stock_name': u'\u5c71\u4e1c\u9ec4\u91d1',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 737716.0,
	 'rongquan_maichu': 734915.0,
	 'rongquan_yuliang': 210700.0,
	 'rongzi_changhuan': 213692026.0,
	 'rongzi_mairu': 218774383.0,
	 'rongzi_yue': 1606056842.0,
	 'stock_code': u'600549',
	 'stock_name': u'\u53a6\u95e8\u94a8\u4e1a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 147700.0,
	 'rongquan_maichu': 148700.0,
	 'rongquan_yuliang': 19900.0,
	 'rongzi_changhuan': 84352712.0,
	 'rongzi_mairu': 97739020.0,
	 'rongzi_yue': 658902627.0,
	 'stock_code': u'600551',
	 'stock_name': u'\u65f6\u4ee3\u51fa\u7248',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 5000.0,
	 'rongquan_maichu': 4300.0,
	 'rongquan_yuliang': 14900.0,
	 'rongzi_changhuan': 143546140.0,
	 'rongzi_mairu': 118173446.0,
	 'rongzi_yue': 1315452082.0,
	 'stock_code': u'600557',
	 'stock_name': u'\u5eb7\u7f18\u836f\u4e1a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 54700.0,
	 'rongquan_maichu': 54800.0,
	 'rongquan_yuliang': 15142.0,
	 'rongzi_changhuan': 42787278.0,
	 'rongzi_mairu': 21797743.0,
	 'rongzi_yue': 202574398.0,
	 'stock_code': u'600559',
	 'stock_name': u'\u8001\u767d\u5e72\u9152',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 67200.0,
	 'rongquan_maichu': 67200.0,
	 'rongquan_yuliang': 9700.0,
	 'rongzi_changhuan': 59940308.0,
	 'rongzi_mairu': 64425051.0,
	 'rongzi_yue': 618937982.0,
	 'stock_code': u'600563',
	 'stock_name': u'\u6cd5\u62c9\u7535\u5b50',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 7000.0,
	 'rongquan_maichu': 13500.0,
	 'rongquan_yuliang': 12200.0,
	 'rongzi_changhuan': 46622582.0,
	 'rongzi_mairu': 33033159.0,
	 'rongzi_yue': 382748538.0,
	 'stock_code': u'600566',
	 'stock_name': u'\u6d4e\u5ddd\u836f\u4e1a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 49800.0,
	 'rongquan_maichu': 49000.0,
	 'rongquan_yuliang': 46600.0,
	 'rongzi_changhuan': 71869684.0,
	 'rongzi_mairu': 84037536.0,
	 'rongzi_yue': 689785189.0,
	 'stock_code': u'600568',
	 'stock_name': u'\u4e2d\u73e0\u63a7\u80a1',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 297568.0,
	 'rongquan_maichu': 299168.0,
	 'rongquan_yuliang': 152200.0,
	 'rongzi_changhuan': 403916979.0,
	 'rongzi_mairu': 562833877.0,
	 'rongzi_yue': 5419763216.0,
	 'stock_code': u'600570',
	 'stock_name': u'\u6052\u751f\u7535\u5b50',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 10700.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 12200.0,
	 'rongzi_changhuan': 105756019.0,
	 'rongzi_mairu': 87696582.0,
	 'rongzi_yue': 1067938211.0,
	 'stock_code': u'600572',
	 'stock_name': u'\u5eb7\u6069\u8d1d',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 2710005.0,
	 'rongquan_maichu': 2707805.0,
	 'rongquan_yuliang': 163700.0,
	 'rongzi_changhuan': 167296680.0,
	 'rongzi_mairu': 145582992.0,
	 'rongzi_yue': 899661503.0,
	 'stock_code': u'600578',
	 'stock_name': u'\u4eac\u80fd\u7535\u529b',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 225730.0,
	 'rongquan_maichu': 225630.0,
	 'rongquan_yuliang': 17400.0,
	 'rongzi_changhuan': 69472271.0,
	 'rongzi_mairu': 71039762.0,
	 'rongzi_yue': 732538338.0,
	 'stock_code': u'600580',
	 'stock_name': u'\u5367\u9f99\u7535\u6c14',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 78000.0,
	 'rongquan_maichu': 66900.0,
	 'rongquan_yuliang': 103500.0,
	 'rongzi_changhuan': 77127615.0,
	 'rongzi_mairu': 115392948.0,
	 'rongzi_yue': 1010602089.0,
	 'stock_code': u'600582',
	 'stock_name': u'\u5929\u5730\u79d1\u6280',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 3795512.0,
	 'rongquan_maichu': 3784612.0,
	 'rongquan_yuliang': 480625.0,
	 'rongzi_changhuan': 1019447508.0,
	 'rongzi_mairu': 1243937773.0,
	 'rongzi_yue': 3956081462.0,
	 'stock_code': u'600583',
	 'stock_name': u'\u6d77\u6cb9\u5de5\u7a0b',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 79127.0,
	 'rongzi_changhuan': 19378752.0,
	 'rongzi_mairu': 0.0,
	 'rongzi_yue': 828126097.0,
	 'stock_code': u'600584',
	 'stock_name': u'\u957f\u7535\u79d1\u6280',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 3066649.0,
	 'rongquan_maichu': 3113489.0,
	 'rongquan_yuliang': 1101462.0,
	 'rongzi_changhuan': 682101938.0,
	 'rongzi_mairu': 731194325.0,
	 'rongzi_yue': 3461605575.0,
	 'stock_code': u'600585',
	 'stock_name': u'\u6d77\u87ba\u6c34\u6ce5',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 23635.0,
	 'rongquan_maichu': 22085.0,
	 'rongquan_yuliang': 9504.0,
	 'rongzi_changhuan': 169334348.0,
	 'rongzi_mairu': 247288323.0,
	 'rongzi_yue': 1373800376.0,
	 'stock_code': u'600587',
	 'stock_name': u'\u65b0\u534e\u533b\u7597',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 711987.0,
	 'rongquan_maichu': 689187.0,
	 'rongquan_yuliang': 266760.0,
	 'rongzi_changhuan': 332761328.0,
	 'rongzi_mairu': 257138370.0,
	 'rongzi_yue': 3175849068.0,
	 'stock_code': u'600588',
	 'stock_name': u'\u7528\u53cb\u7f51\u7edc',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 18829.0,
	 'rongquan_maichu': 18829.0,
	 'rongquan_yuliang': 2200.0,
	 'rongzi_changhuan': 76825902.0,
	 'rongzi_mairu': 64728651.0,
	 'rongzi_yue': 690516255.0,
	 'stock_code': u'600592',
	 'stock_name': u'\u9f99\u6eaa\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 13000.0,
	 'rongquan_maichu': 13000.0,
	 'rongquan_yuliang': 9089.0,
	 'rongzi_changhuan': 59926938.0,
	 'rongzi_mairu': 84851504.0,
	 'rongzi_yue': 1392660163.0,
	 'stock_code': u'600594',
	 'stock_name': u'\u76ca\u4f70\u5236\u836f',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 87000.0,
	 'rongquan_maichu': 87000.0,
	 'rongquan_yuliang': 43922.0,
	 'rongzi_changhuan': 123154685.0,
	 'rongzi_mairu': 103296431.0,
	 'rongzi_yue': 616155483.0,
	 'stock_code': u'600595',
	 'stock_name': u'\u4e2d\u5b5a\u5b9e\u4e1a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 44600.0,
	 'rongquan_maichu': 44600.0,
	 'rongquan_yuliang': 21660.0,
	 'rongzi_changhuan': 101764340.0,
	 'rongzi_mairu': 104922374.0,
	 'rongzi_yue': 1088802424.0,
	 'stock_code': u'600596',
	 'stock_name': u'\u65b0\u5b89\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 195555.0,
	 'rongzi_changhuan': 35477799.0,
	 'rongzi_mairu': 0.0,
	 'rongzi_yue': 599923397.0,
	 'stock_code': u'600597',
	 'stock_name': u'\u5149\u660e\u4e73\u4e1a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 198878.0,
	 'rongquan_maichu': 191078.0,
	 'rongquan_yuliang': 396335.0,
	 'rongzi_changhuan': 63130957.0,
	 'rongzi_mairu': 94693388.0,
	 'rongzi_yue': 1059458938.0,
	 'stock_code': u'600600',
	 'stock_name': u'\u9752\u5c9b\u5564\u9152',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 40000.0,
	 'rongquan_maichu': 40000.0,
	 'rongquan_yuliang': 46900.0,
	 'rongzi_changhuan': 338868375.0,
	 'rongzi_mairu': 312961042.0,
	 'rongzi_yue': 2692507029.0,
	 'stock_code': u'600601',
	 'stock_name': u'\u65b9\u6b63\u79d1\u6280',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 19500.0,
	 'rongquan_maichu': 19500.0,
	 'rongquan_yuliang': 7000.0,
	 'rongzi_changhuan': 34988775.0,
	 'rongzi_mairu': 39164342.0,
	 'rongzi_yue': 285827078.0,
	 'stock_code': u'600604',
	 'stock_name': u'\u5e02\u5317\u9ad8\u65b0',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 44479.0,
	 'rongzi_changhuan': 25126691.0,
	 'rongzi_mairu': 0.0,
	 'rongzi_yue': 949898882.0,
	 'stock_code': u'600606',
	 'stock_name': u'\u91d1\u4e30\u6295\u8d44',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 78000.0,
	 'rongzi_changhuan': 26202452.0,
	 'rongzi_mairu': 0.0,
	 'rongzi_yue': 624110341.0,
	 'stock_code': u'600609',
	 'stock_name': u'\u91d1\u676f\u6c7d\u8f66',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 33400.0,
	 'rongquan_maichu': 47400.0,
	 'rongquan_yuliang': 29845.0,
	 'rongzi_changhuan': 212574720.0,
	 'rongzi_mairu': 209514322.0,
	 'rongzi_yue': 1799202238.0,
	 'stock_code': u'600611',
	 'stock_name': u'\u5927\u4f17\u4ea4\u901a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 54300.0,
	 'rongzi_changhuan': 4589090.0,
	 'rongzi_mairu': 0.0,
	 'rongzi_yue': 516838563.0,
	 'stock_code': u'600614',
	 'stock_name': u'\u9f0e\u7acb\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 47000.0,
	 'rongquan_maichu': 47500.0,
	 'rongquan_yuliang': 63500.0,
	 'rongzi_changhuan': 39420648.0,
	 'rongzi_mairu': 33512783.0,
	 'rongzi_yue': 496214248.0,
	 'stock_code': u'600616',
	 'stock_name': u'\u91d1\u67ab\u9152\u4e1a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 1700.0,
	 'rongquan_maichu': 1700.0,
	 'rongquan_yuliang': 35100.0,
	 'rongzi_changhuan': 55905907.0,
	 'rongzi_mairu': 78173326.0,
	 'rongzi_yue': 1004993941.0,
	 'stock_code': u'600620',
	 'stock_name': u'\u5929\u5bb8\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 58500.0,
	 'rongquan_maichu': 66100.0,
	 'rongquan_yuliang': 39200.0,
	 'rongzi_changhuan': 95061858.0,
	 'rongzi_mairu': 63532866.0,
	 'rongzi_yue': 934613995.0,
	 'stock_code': u'600624',
	 'stock_name': u'\u590d\u65e6\u590d\u534e',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 20000.0,
	 'rongzi_changhuan': 249370669.0,
	 'rongzi_mairu': 163768627.0,
	 'rongzi_yue': 1291954544.0,
	 'stock_code': u'600626',
	 'stock_name': u'\u7533\u8fbe\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 347558.0,
	 'rongquan_maichu': 354558.0,
	 'rongquan_yuliang': 71210.0,
	 'rongzi_changhuan': 204647408.0,
	 'rongzi_mairu': 211907304.0,
	 'rongzi_yue': 2343671007.0,
	 'stock_code': u'600633',
	 'stock_name': u'\u6d59\u62a5\u4f20\u5a92',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 588916.0,
	 'rongquan_maichu': 618516.0,
	 'rongquan_yuliang': 50400.0,
	 'rongzi_changhuan': 266040028.0,
	 'rongzi_mairu': 261948624.0,
	 'rongzi_yue': 2005237279.0,
	 'stock_code': u'600635',
	 'stock_name': u'\u5927\u4f17\u516c\u7528',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 97330.0,
	 'rongquan_maichu': 99730.0,
	 'rongquan_yuliang': 27270.0,
	 'rongzi_changhuan': 110095171.0,
	 'rongzi_mairu': 81209908.0,
	 'rongzi_yue': 728430495.0,
	 'stock_code': u'600636',
	 'stock_name': u'\u4e09\u7231\u5bcc',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 791599.0,
	 'rongquan_maichu': 813399.0,
	 'rongquan_yuliang': 109594.0,
	 'rongzi_changhuan': 401633701.0,
	 'rongzi_mairu': 388300553.0,
	 'rongzi_yue': 4462373745.0,
	 'stock_code': u'600637',
	 'stock_name': u'\u767e\u89c6\u901a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 119700.0,
	 'rongquan_maichu': 119937.0,
	 'rongquan_yuliang': 23437.0,
	 'rongzi_changhuan': 121010287.0,
	 'rongzi_mairu': 90788310.0,
	 'rongzi_yue': 801151162.0,
	 'stock_code': u'600639',
	 'stock_name': u'\u6d66\u4e1c\u91d1\u6865',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 131800.0,
	 'rongquan_maichu': 131700.0,
	 'rongquan_yuliang': 26425.0,
	 'rongzi_changhuan': 113367457.0,
	 'rongzi_mairu': 104906181.0,
	 'rongzi_yue': 818556307.0,
	 'stock_code': u'600640',
	 'stock_name': u'\u53f7\u767e\u63a7\u80a1',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 3418048.0,
	 'rongquan_maichu': 3452244.0,
	 'rongquan_yuliang': 858129.0,
	 'rongzi_changhuan': 217259125.0,
	 'rongzi_mairu': 226424979.0,
	 'rongzi_yue': 1360362585.0,
	 'stock_code': u'600642',
	 'stock_name': u'\u7533\u80fd\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 407700.0,
	 'rongquan_maichu': 407900.0,
	 'rongquan_yuliang': 17799.0,
	 'rongzi_changhuan': 173075614.0,
	 'rongzi_mairu': 178759956.0,
	 'rongzi_yue': 1650777441.0,
	 'stock_code': u'600643',
	 'stock_name': u'\u7231\u5efa\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 27627.0,
	 'rongquan_maichu': 27727.0,
	 'rongquan_yuliang': 20756.0,
	 'rongzi_changhuan': 241883871.0,
	 'rongzi_mairu': 197948732.0,
	 'rongzi_yue': 2286745543.0,
	 'stock_code': u'600645',
	 'stock_name': u'\u4e2d\u6e90\u534f\u548c',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 241650.0,
	 'rongquan_maichu': 238150.0,
	 'rongquan_yuliang': 17700.0,
	 'rongzi_changhuan': 105834099.0,
	 'rongzi_mairu': 90816012.0,
	 'rongzi_yue': 1187621394.0,
	 'stock_code': u'600648',
	 'stock_name': u'\u5916\u9ad8\u6865',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 552832.0,
	 'rongzi_changhuan': 702507.0,
	 'rongzi_mairu': 0.0,
	 'rongzi_yue': 167658033.0,
	 'stock_code': u'600649',
	 'stock_name': u'\u57ce\u6295\u63a7\u80a1',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 1600.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 29800.0,
	 'rongzi_changhuan': 89642330.0,
	 'rongzi_mairu': 82003295.0,
	 'rongzi_yue': 847414242.0,
	 'stock_code': u'600651',
	 'stock_name': u'\u98de\u4e50\u97f3\u54cd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 20000.0,
	 'rongquan_maichu': 20000.0,
	 'rongquan_yuliang': 42100.0,
	 'rongzi_changhuan': 141850018.0,
	 'rongzi_mairu': 108385139.0,
	 'rongzi_yue': 1387950150.0,
	 'stock_code': u'600652',
	 'stock_name': u'\u6e38\u4e45\u6e38\u620f',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 332807.0,
	 'rongquan_maichu': 316707.0,
	 'rongquan_yuliang': 50200.0,
	 'rongzi_changhuan': 93948591.0,
	 'rongzi_mairu': 113755924.0,
	 'rongzi_yue': 810552242.0,
	 'stock_code': u'600653',
	 'stock_name': u'\u7533\u534e\u63a7\u80a1',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 20000.0,
	 'rongquan_maichu': 23600.0,
	 'rongquan_yuliang': 32719.0,
	 'rongzi_changhuan': 135219640.0,
	 'rongzi_mairu': 133607148.0,
	 'rongzi_yue': 1070884370.0,
	 'stock_code': u'600654',
	 'stock_name': u'\u4e2d\u5b89\u6d88',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 380903.0,
	 'rongzi_changhuan': 26451622.0,
	 'rongzi_mairu': 0.0,
	 'rongzi_yue': 909551010.0,
	 'stock_code': u'600655',
	 'stock_name': u'\u8c6b\u56ed\u5546\u57ce',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 725357.0,
	 'rongquan_maichu': 705363.0,
	 'rongquan_yuliang': 896071.0,
	 'rongzi_changhuan': 242894298.0,
	 'rongzi_mairu': 141723735.0,
	 'rongzi_yue': 1593576552.0,
	 'stock_code': u'600660',
	 'stock_name': u'\u798f\u8000\u73bb\u7483',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 5200.0,
	 'rongzi_changhuan': 56303065.0,
	 'rongzi_mairu': 35814768.0,
	 'rongzi_yue': 567427170.0,
	 'stock_code': u'600661',
	 'stock_name': u'\u65b0\u5357\u6d0b',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 6000.0,
	 'rongquan_maichu': 6000.0,
	 'rongquan_yuliang': 26789.0,
	 'rongzi_changhuan': 181802486.0,
	 'rongzi_mairu': 140691543.0,
	 'rongzi_yue': 1443670979.0,
	 'stock_code': u'600662',
	 'stock_name': u'\u5f3a\u751f\u63a7\u80a1',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 308689.0,
	 'rongquan_maichu': 317489.0,
	 'rongquan_yuliang': 60495.0,
	 'rongzi_changhuan': 276625466.0,
	 'rongzi_mairu': 124020463.0,
	 'rongzi_yue': 1295783306.0,
	 'stock_code': u'600663',
	 'stock_name': u'\u9646\u5bb6\u5634',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 252000.0,
	 'rongquan_maichu': 243000.0,
	 'rongquan_yuliang': 219518.0,
	 'rongzi_changhuan': 175845204.0,
	 'rongzi_mairu': 137112434.0,
	 'rongzi_yue': 1502435325.0,
	 'stock_code': u'600664',
	 'stock_name': u'\u54c8\u836f\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 26500.0,
	 'rongzi_changhuan': 4493445.0,
	 'rongzi_mairu': 0.0,
	 'rongzi_yue': 357123261.0,
	 'stock_code': u'600667',
	 'stock_name': u'\u592a\u6781\u5b9e\u4e1a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 2900.0,
	 'rongquan_maichu': 11200.0,
	 'rongquan_yuliang': 79600.0,
	 'rongzi_changhuan': 167380708.0,
	 'rongzi_mairu': 88965026.0,
	 'rongzi_yue': 934717344.0,
	 'stock_code': u'600668',
	 'stock_name': u'\u5c16\u5cf0\u96c6\u56e2',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 15200.0,
	 'rongquan_maichu': 15200.0,
	 'rongquan_yuliang': 14198.0,
	 'rongzi_changhuan': 226639484.0,
	 'rongzi_mairu': 202725287.0,
	 'rongzi_yue': 2050567550.0,
	 'stock_code': u'600673',
	 'stock_name': u'\u4e1c\u9633\u5149\u79d1',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 970564.0,
	 'rongquan_maichu': 987065.0,
	 'rongquan_yuliang': 683240.0,
	 'rongzi_changhuan': 355374590.0,
	 'rongzi_mairu': 294255102.0,
	 'rongzi_yue': 3580496468.0,
	 'stock_code': u'600674',
	 'stock_name': u'\u5ddd\u6295\u80fd\u6e90',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 132600.0,
	 'rongquan_maichu': 134400.0,
	 'rongquan_yuliang': 114055.0,
	 'rongzi_changhuan': 174884785.0,
	 'rongzi_mairu': 180486446.0,
	 'rongzi_yue': 1653407719.0,
	 'stock_code': u'600675',
	 'stock_name': u'\u4e2d\u534e\u4f01\u4e1a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 17000.0,
	 'rongzi_changhuan': 4152754.0,
	 'rongzi_mairu': 0.0,
	 'rongzi_yue': 190248697.0,
	 'stock_code': u'600677',
	 'stock_name': u'\u822a\u5929\u901a\u4fe1',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 0.0,
	 'rongzi_changhuan': 48357316.0,
	 'rongzi_mairu': 35234335.0,
	 'rongzi_yue': 257843648.0,
	 'stock_code': u'600680',
	 'stock_name': u'\u4e0a\u6d77\u666e\u5929',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 44100.0,
	 'rongquan_maichu': 43600.0,
	 'rongquan_yuliang': 63100.0,
	 'rongzi_changhuan': 148885965.0,
	 'rongzi_mairu': 169442799.0,
	 'rongzi_yue': 956399857.0,
	 'stock_code': u'600684',
	 'stock_name': u'\u73e0\u6c5f\u5b9e\u4e1a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 6669740.0,
	 'rongquan_maichu': 6572440.0,
	 'rongquan_yuliang': 701987.0,
	 'rongzi_changhuan': 222218626.0,
	 'rongzi_mairu': 220825825.0,
	 'rongzi_yue': 1191953737.0,
	 'stock_code': u'600688',
	 'stock_name': u'\u4e0a\u6d77\u77f3\u5316',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 1318622.0,
	 'rongquan_maichu': 1358022.0,
	 'rongquan_yuliang': 536913.0,
	 'rongzi_changhuan': 389102786.0,
	 'rongzi_mairu': 278250722.0,
	 'rongzi_yue': 2387554022.0,
	 'stock_code': u'600690',
	 'stock_name': u'\u9752\u5c9b\u6d77\u5c14',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 44500.0,
	 'rongquan_maichu': 72100.0,
	 'rongquan_yuliang': 94100.0,
	 'rongzi_changhuan': 90215062.0,
	 'rongzi_mairu': 72124358.0,
	 'rongzi_yue': 706614312.0,
	 'stock_code': u'600692',
	 'stock_name': u'\u4e9a\u901a\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 119513.0,
	 'rongquan_maichu': 122611.0,
	 'rongquan_yuliang': 36198.0,
	 'rongzi_changhuan': 168100524.0,
	 'rongzi_mairu': 163336849.0,
	 'rongzi_yue': 1572608420.0,
	 'stock_code': u'600694',
	 'stock_name': u'\u5927\u5546\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 55000.0,
	 'rongzi_changhuan': 23904283.0,
	 'rongzi_mairu': 0.0,
	 'rongzi_yue': 660645485.0,
	 'stock_code': u'600696',
	 'stock_name': u'\u591a\u4f26\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 136018.0,
	 'rongquan_maichu': 136018.0,
	 'rongquan_yuliang': 28500.0,
	 'rongzi_changhuan': 136285381.0,
	 'rongzi_mairu': 102406300.0,
	 'rongzi_yue': 1246774965.0,
	 'stock_code': u'600699',
	 'stock_name': u'\u5747\u80dc\u7535\u5b50',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 301200.0,
	 'rongquan_maichu': 292200.0,
	 'rongquan_yuliang': 12400.0,
	 'rongzi_changhuan': 73376220.0,
	 'rongzi_mairu': 67285560.0,
	 'rongzi_yue': 600330514.0,
	 'stock_code': u'600702',
	 'stock_name': u'\u6cb1\u724c\u820d\u5f97',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 1967945.0,
	 'rongquan_maichu': 1897445.0,
	 'rongquan_yuliang': 503152.0,
	 'rongzi_changhuan': 533249722.0,
	 'rongzi_mairu': 606884434.0,
	 'rongzi_yue': 2893485579.0,
	 'stock_code': u'600703',
	 'stock_name': u'\u4e09\u5b89\u5149\u7535',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 57984.0,
	 'rongquan_maichu': 54000.0,
	 'rongquan_yuliang': 6816.0,
	 'rongzi_changhuan': 238402175.0,
	 'rongzi_mairu': 192876803.0,
	 'rongzi_yue': 1884357954.0,
	 'stock_code': u'600704',
	 'stock_name': u'\u7269\u4ea7\u4e2d\u5927',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 4406846.0,
	 'rongquan_maichu': 4373746.0,
	 'rongquan_yuliang': 170251.0,
	 'rongzi_changhuan': 925236597.0,
	 'rongzi_mairu': 680832715.0,
	 'rongzi_yue': 7916468375.0,
	 'stock_code': u'600705',
	 'stock_name': u'\u4e2d\u822a\u8d44\u672c',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 35401.0,
	 'rongquan_maichu': 35601.0,
	 'rongquan_yuliang': 6500.0,
	 'rongzi_changhuan': 92718060.0,
	 'rongzi_mairu': 103014721.0,
	 'rongzi_yue': 722557443.0,
	 'stock_code': u'600707',
	 'stock_name': u'\u5f69\u8679\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 274200.0,
	 'rongquan_maichu': 275200.0,
	 'rongquan_yuliang': 63300.0,
	 'rongzi_changhuan': 163378344.0,
	 'rongzi_mairu': 178328274.0,
	 'rongzi_yue': 1539638281.0,
	 'stock_code': u'600711',
	 'stock_name': u'\u76db\u5c6f\u77ff\u4e1a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 5600.0,
	 'rongquan_maichu': 27600.0,
	 'rongquan_yuliang': 25800.0,
	 'rongzi_changhuan': 97109319.0,
	 'rongzi_mairu': 107103169.0,
	 'rongzi_yue': 871062233.0,
	 'stock_code': u'600716',
	 'stock_name': u'\u51e4\u51f0\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 217800.0,
	 'rongquan_maichu': 217800.0,
	 'rongquan_yuliang': 2800.0,
	 'rongzi_changhuan': 379094989.0,
	 'rongzi_mairu': 360901895.0,
	 'rongzi_yue': 1946661758.0,
	 'stock_code': u'600717',
	 'stock_name': u'\u5929\u6d25\u6e2f',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 868703.0,
	 'rongquan_maichu': 868053.0,
	 'rongquan_yuliang': 107600.0,
	 'rongzi_changhuan': 242710942.0,
	 'rongzi_mairu': 208177520.0,
	 'rongzi_yue': 3241825302.0,
	 'stock_code': u'600718',
	 'stock_name': u'\u4e1c\u8f6f\u96c6\u56e2',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 166500.0,
	 'rongquan_maichu': 171600.0,
	 'rongquan_yuliang': 39900.0,
	 'rongzi_changhuan': 153968826.0,
	 'rongzi_mairu': 185528764.0,
	 'rongzi_yue': 1069710247.0,
	 'stock_code': u'600720',
	 'stock_name': u'\u7941\u8fde\u5c71',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 47400.0,
	 'rongquan_maichu': 46400.0,
	 'rongquan_yuliang': 3850.0,
	 'rongzi_changhuan': 118121863.0,
	 'rongzi_mairu': 159660976.0,
	 'rongzi_yue': 1058062714.0,
	 'stock_code': u'600728',
	 'stock_name': u'\u4f73\u90fd\u79d1\u6280',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 1700.0,
	 'rongquan_maichu': 900.0,
	 'rongquan_yuliang': 25588.0,
	 'rongzi_changhuan': 71165565.0,
	 'rongzi_mairu': 62618349.0,
	 'rongzi_yue': 769351214.0,
	 'stock_code': u'600729',
	 'stock_name': u'\u91cd\u5e86\u767e\u8d27',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 0.0,
	 'rongzi_changhuan': 123593173.0,
	 'rongzi_mairu': 111104857.0,
	 'rongzi_yue': 653498676.0,
	 'stock_code': u'600730',
	 'stock_name': u'\u4e2d\u56fd\u9ad8\u79d1',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 123500.0,
	 'rongquan_maichu': 123500.0,
	 'rongquan_yuliang': 39232.0,
	 'rongzi_changhuan': 377970751.0,
	 'rongzi_mairu': 345025988.0,
	 'rongzi_yue': 2033641686.0,
	 'stock_code': u'600737',
	 'stock_name': u'\u4e2d\u7cae\u5c6f\u6cb3',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 934846.0,
	 'rongquan_maichu': 865746.0,
	 'rongquan_yuliang': 435201.0,
	 'rongzi_changhuan': 393947849.0,
	 'rongzi_mairu': 379629782.0,
	 'rongzi_yue': 5625839400.0,
	 'stock_code': u'600739',
	 'stock_name': u'\u8fbd\u5b81\u6210\u5927',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 2929386.0,
	 'rongquan_maichu': 3090886.0,
	 'rongquan_yuliang': 901483.0,
	 'rongzi_changhuan': 124374910.0,
	 'rongzi_mairu': 130111981.0,
	 'rongzi_yue': 627793875.0,
	 'stock_code': u'600740',
	 'stock_name': u'\u5c71\u897f\u7126\u5316',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 781233.0,
	 'rongzi_changhuan': 3437113.0,
	 'rongzi_mairu': 0.0,
	 'rongzi_yue': 349708849.0,
	 'stock_code': u'600741',
	 'stock_name': u'\u534e\u57df\u6c7d\u8f66',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 150600.0,
	 'rongquan_maichu': 152000.0,
	 'rongquan_yuliang': 20578.0,
	 'rongzi_changhuan': 149046406.0,
	 'rongzi_mairu': 118647432.0,
	 'rongzi_yue': 945465962.0,
	 'stock_code': u'600742',
	 'stock_name': u'\u4e00\u6c7d\u5bcc\u7ef4',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 30200.0,
	 'rongquan_maichu': 37800.0,
	 'rongquan_yuliang': 105789.0,
	 'rongzi_changhuan': 65090084.0,
	 'rongzi_mairu': 69681272.0,
	 'rongzi_yue': 605589179.0,
	 'stock_code': u'600743',
	 'stock_name': u'\u534e\u8fdc\u5730\u4ea7',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 19800.0,
	 'rongquan_maichu': 19800.0,
	 'rongquan_yuliang': 37900.0,
	 'rongzi_changhuan': 34064765.0,
	 'rongzi_mairu': 48864646.0,
	 'rongzi_yue': 422203603.0,
	 'stock_code': u'600744',
	 'stock_name': u'\u534e\u94f6\u7535\u529b',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 58500.0,
	 'rongzi_changhuan': 5455116.0,
	 'rongzi_mairu': 0.0,
	 'rongzi_yue': 611802302.0,
	 'stock_code': u'600747',
	 'stock_name': u'\u5927\u8fde\u63a7\u80a1',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 109100.0,
	 'rongzi_changhuan': 15320731.0,
	 'rongzi_mairu': 0.0,
	 'rongzi_yue': 405117294.0,
	 'stock_code': u'600748',
	 'stock_name': u'\u4e0a\u5b9e\u53d1\u5c55',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 12000.0,
	 'rongquan_maichu': 11100.0,
	 'rongquan_yuliang': 37456.0,
	 'rongzi_changhuan': 32069040.0,
	 'rongzi_mairu': 33959705.0,
	 'rongzi_yue': 450197527.0,
	 'stock_code': u'600750',
	 'stock_name': u'\u6c5f\u4e2d\u836f\u4e1a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 294213.0,
	 'rongquan_maichu': 294213.0,
	 'rongquan_yuliang': 800.0,
	 'rongzi_changhuan': 123538174.0,
	 'rongzi_mairu': 88152863.0,
	 'rongzi_yue': 432292625.0,
	 'stock_code': u'600751',
	 'stock_name': u'\u5929\u6d25\u6d77\u8fd0',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 259298.0,
	 'rongquan_maichu': 263598.0,
	 'rongquan_yuliang': 32400.0,
	 'rongzi_changhuan': 459163019.0,
	 'rongzi_mairu': 492000670.0,
	 'rongzi_yue': 2610725625.0,
	 'stock_code': u'600755',
	 'stock_name': u'\u53a6\u95e8\u56fd\u8d38',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 20000.0,
	 'rongzi_changhuan': 12843310.0,
	 'rongzi_mairu': 0.0,
	 'rongzi_yue': 350816059.0,
	 'stock_code': u'600756',
	 'stock_name': u'\u6d6a\u6f6e\u8f6f\u4ef6',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 10800.0,
	 'rongquan_maichu': 10800.0,
	 'rongquan_yuliang': 100.0,
	 'rongzi_changhuan': 89986370.0,
	 'rongzi_mairu': 124014868.0,
	 'rongzi_yue': 1404901604.0,
	 'stock_code': u'600757',
	 'stock_name': u'\u957f\u6c5f\u4f20\u5a92',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 72100.0,
	 'rongquan_maichu': 78100.0,
	 'rongquan_yuliang': 113300.0,
	 'rongzi_changhuan': 205595476.0,
	 'rongzi_mairu': 232802760.0,
	 'rongzi_yue': 1511144942.0,
	 'stock_code': u'600759',
	 'stock_name': u'\u6d32\u9645\u6cb9\u6c14',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 165495.0,
	 'rongquan_maichu': 166195.0,
	 'rongquan_yuliang': 4700.0,
	 'rongzi_changhuan': 84998875.0,
	 'rongzi_mairu': 67631350.0,
	 'rongzi_yue': 680190903.0,
	 'stock_code': u'600761',
	 'stock_name': u'\u5b89\u5fbd\u5408\u529b',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 231000.0,
	 'rongquan_maichu': 232100.0,
	 'rongquan_yuliang': 16100.0,
	 'rongzi_changhuan': 438936975.0,
	 'rongzi_mairu': 477725505.0,
	 'rongzi_yue': 2167959273.0,
	 'stock_code': u'600765',
	 'stock_name': u'\u4e2d\u822a\u91cd\u673a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 108600.0,
	 'rongquan_maichu': 108600.0,
	 'rongquan_yuliang': 109004.0,
	 'rongzi_changhuan': 234940186.0,
	 'rongzi_mairu': 167243537.0,
	 'rongzi_yue': 2049506987.0,
	 'stock_code': u'600770',
	 'stock_name': u'\u7efc\u827a\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 28000.0,
	 'rongquan_maichu': 28000.0,
	 'rongquan_yuliang': 3900.0,
	 'rongzi_changhuan': 30603480.0,
	 'rongzi_mairu': 56770174.0,
	 'rongzi_yue': 564352075.0,
	 'stock_code': u'600771',
	 'stock_name': u'\u5e7f\u8a89\u8fdc',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 71300.0,
	 'rongquan_maichu': 76100.0,
	 'rongquan_yuliang': 29400.0,
	 'rongzi_changhuan': 56869808.0,
	 'rongzi_mairu': 49086740.0,
	 'rongzi_yue': 571940004.0,
	 'stock_code': u'600773',
	 'stock_name': u'\u897f\u85cf\u57ce\u6295',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 32000.0,
	 'rongquan_maichu': 32000.0,
	 'rongquan_yuliang': 32400.0,
	 'rongzi_changhuan': 76415848.0,
	 'rongzi_mairu': 68925159.0,
	 'rongzi_yue': 800156176.0,
	 'stock_code': u'600775',
	 'stock_name': u'\u5357\u4eac\u718a\u732b',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 5700.0,
	 'rongquan_maichu': 5700.0,
	 'rongquan_yuliang': 15500.0,
	 'rongzi_changhuan': 56153344.0,
	 'rongzi_mairu': 79998832.0,
	 'rongzi_yue': 1029812487.0,
	 'stock_code': u'600776',
	 'stock_name': u'\u4e1c\u65b9\u901a\u4fe1',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 0.0,
	 'rongzi_changhuan': 1545021.0,
	 'rongzi_mairu': 0.0,
	 'rongzi_yue': 247336120.0,
	 'stock_code': u'600777',
	 'stock_name': u'\u65b0\u6f6e\u5b9e\u4e1a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 127600.0,
	 'rongquan_maichu': 130800.0,
	 'rongquan_yuliang': 73700.0,
	 'rongzi_changhuan': 48316098.0,
	 'rongzi_mairu': 46949553.0,
	 'rongzi_yue': 445881637.0,
	 'stock_code': u'600779',
	 'stock_name': u'\u6c34\u4e95\u574a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 772735.0,
	 'rongquan_maichu': 772035.0,
	 'rongquan_yuliang': 78992.0,
	 'rongzi_changhuan': 171167828.0,
	 'rongzi_mairu': 174853977.0,
	 'rongzi_yue': 1647596937.0,
	 'stock_code': u'600783',
	 'stock_name': u'\u9c81\u4fe1\u521b\u6295',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 1011604.0,
	 'rongquan_maichu': 1010604.0,
	 'rongquan_yuliang': 53700.0,
	 'rongzi_changhuan': 316913911.0,
	 'rongzi_mairu': 405727304.0,
	 'rongzi_yue': 2107093735.0,
	 'stock_code': u'600787',
	 'stock_name': u'\u4e2d\u50a8\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 32700.0,
	 'rongquan_maichu': 32700.0,
	 'rongquan_yuliang': 31300.0,
	 'rongzi_changhuan': 100315402.0,
	 'rongzi_mairu': 91175068.0,
	 'rongzi_yue': 750615358.0,
	 'stock_code': u'600789',
	 'stock_name': u'\u9c81\u6297\u533b\u836f',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 23800.0,
	 'rongquan_maichu': 23800.0,
	 'rongquan_yuliang': 2600.0,
	 'rongzi_changhuan': 221751320.0,
	 'rongzi_mairu': 183880900.0,
	 'rongzi_yue': 1136271074.0,
	 'stock_code': u'600790',
	 'stock_name': u'\u8f7b\u7eba\u57ce',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 197390830.0,
	 'rongquan_maichu': 196753230.0,
	 'rongquan_yuliang': 2597400.0,
	 'rongzi_changhuan': 1390430599.0,
	 'rongzi_mairu': 1205222705.0,
	 'rongzi_yue': 5260843878.0,
	 'stock_code': u'600795',
	 'stock_name': u'\u56fd\u7535\u7535\u529b',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 18300.0,
	 'rongzi_changhuan': 11165464.0,
	 'rongzi_mairu': 0.0,
	 'rongzi_yue': 580820748.0,
	 'stock_code': u'600797',
	 'stock_name': u'\u6d59\u5927\u7f51\u65b0',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 185900.0,
	 'rongquan_maichu': 185800.0,
	 'rongquan_yuliang': 85700.0,
	 'rongzi_changhuan': 146624644.0,
	 'rongzi_mairu': 123338242.0,
	 'rongzi_yue': 765651942.0,
	 'stock_code': u'600800',
	 'stock_name': u'\u5929\u6d25\u78c1\u5361',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 225320.0,
	 'rongquan_maichu': 213420.0,
	 'rongquan_yuliang': 25818.0,
	 'rongzi_changhuan': 106998798.0,
	 'rongzi_mairu': 85550468.0,
	 'rongzi_yue': 536332472.0,
	 'stock_code': u'600801',
	 'stock_name': u'\u534e\u65b0\u6c34\u6ce5',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 31400.0,
	 'rongquan_maichu': 31400.0,
	 'rongquan_yuliang': 30700.0,
	 'rongzi_changhuan': 101424968.0,
	 'rongzi_mairu': 109479761.0,
	 'rongzi_yue': 512759112.0,
	 'stock_code': u'600802',
	 'stock_name': u'\u798f\u5efa\u6c34\u6ce5',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 1442360.0,
	 'rongquan_maichu': 1412561.0,
	 'rongquan_yuliang': 345400.0,
	 'rongzi_changhuan': 431508338.0,
	 'rongzi_mairu': 379206172.0,
	 'rongzi_yue': 5056955397.0,
	 'stock_code': u'600804',
	 'stock_name': u'\u9e4f\u535a\u58eb',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 196340.0,
	 'rongquan_maichu': 192440.0,
	 'rongquan_yuliang': 45400.0,
	 'rongzi_changhuan': 240733742.0,
	 'rongzi_mairu': 218295568.0,
	 'rongzi_yue': 1611420110.0,
	 'stock_code': u'600805',
	 'stock_name': u'\u60a6\u8fbe\u6295\u8d44',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 200.0,
	 'rongquan_maichu': 1000.0,
	 'rongquan_yuliang': 30300.0,
	 'rongzi_changhuan': 62905631.0,
	 'rongzi_mairu': 61680292.0,
	 'rongzi_yue': 457913628.0,
	 'stock_code': u'600807',
	 'stock_name': u'\u5929\u4e1a\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 281300.0,
	 'rongquan_maichu': 281300.0,
	 'rongquan_yuliang': 114400.0,
	 'rongzi_changhuan': 309336397.0,
	 'rongzi_mairu': 293017728.0,
	 'rongzi_yue': 1271103842.0,
	 'stock_code': u'600808',
	 'stock_name': u'\u9a6c\u94a2\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 883967.0,
	 'rongquan_maichu': 854767.0,
	 'rongquan_yuliang': 227888.0,
	 'rongzi_changhuan': 86721378.0,
	 'rongzi_mairu': 97700737.0,
	 'rongzi_yue': 790409608.0,
	 'stock_code': u'600809',
	 'stock_name': u'\u5c71\u897f\u6c7e\u9152',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 316600.0,
	 'rongquan_maichu': 315300.0,
	 'rongquan_yuliang': 80722.0,
	 'rongzi_changhuan': 285520280.0,
	 'rongzi_mairu': 292150289.0,
	 'rongzi_yue': 2563796061.0,
	 'stock_code': u'600811',
	 'stock_name': u'\u4e1c\u65b9\u96c6\u56e2',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 119900.0,
	 'rongquan_maichu': 121900.0,
	 'rongquan_yuliang': 122100.0,
	 'rongzi_changhuan': 158464460.0,
	 'rongzi_mairu': 158227478.0,
	 'rongzi_yue': 1055055540.0,
	 'stock_code': u'600815',
	 'stock_name': u'\u53a6\u5de5\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 213790.0,
	 'rongquan_maichu': 209890.0,
	 'rongquan_yuliang': 75022.0,
	 'rongzi_changhuan': 295900721.0,
	 'rongzi_mairu': 231605634.0,
	 'rongzi_yue': 2023176469.0,
	 'stock_code': u'600816',
	 'stock_name': u'\u5b89\u4fe1\u4fe1\u6258',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 562900.0,
	 'rongquan_maichu': 566300.0,
	 'rongquan_yuliang': 33200.0,
	 'rongzi_changhuan': 476201830.0,
	 'rongzi_mairu': 534610723.0,
	 'rongzi_yue': 2581574227.0,
	 'stock_code': u'600820',
	 'stock_name': u'\u96a7\u9053\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 30800.0,
	 'rongquan_maichu': 38900.0,
	 'rongquan_yuliang': 117201.0,
	 'rongzi_changhuan': 83490480.0,
	 'rongzi_mairu': 94482764.0,
	 'rongzi_yue': 729904747.0,
	 'stock_code': u'600823',
	 'stock_name': u'\u4e16\u8302\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 1437893.0,
	 'rongquan_maichu': 1436393.0,
	 'rongquan_yuliang': 13000.0,
	 'rongzi_changhuan': 136206539.0,
	 'rongzi_mairu': 116758010.0,
	 'rongzi_yue': 1477982146.0,
	 'stock_code': u'600825',
	 'stock_name': u'\u65b0\u534e\u4f20\u5a92',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 600.0,
	 'rongquan_maichu': 300.0,
	 'rongquan_yuliang': 500.0,
	 'rongzi_changhuan': 82113743.0,
	 'rongzi_mairu': 101632962.0,
	 'rongzi_yue': 844090208.0,
	 'stock_code': u'600826',
	 'stock_name': u'\u5170\u751f\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 102157.0,
	 'rongzi_changhuan': 6050247.0,
	 'rongzi_mairu': 0.0,
	 'rongzi_yue': 657291791.0,
	 'stock_code': u'600827',
	 'stock_name': u'\u767e\u8054\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 272500.0,
	 'rongquan_maichu': 272500.0,
	 'rongquan_yuliang': 22199.0,
	 'rongzi_changhuan': 118696390.0,
	 'rongzi_mairu': 159942915.0,
	 'rongzi_yue': 1078039009.0,
	 'stock_code': u'600830',
	 'stock_name': u'\u9999\u6ea2\u878d\u901a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 28000.0,
	 'rongquan_maichu': 28000.0,
	 'rongquan_yuliang': 14900.0,
	 'rongzi_changhuan': 151674459.0,
	 'rongzi_mairu': 142448311.0,
	 'rongzi_yue': 1004904622.0,
	 'stock_code': u'600831',
	 'stock_name': u'\u5e7f\u7535\u7f51\u7edc',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 2463730.0,
	 'rongquan_maichu': 2588000.0,
	 'rongquan_yuliang': 179342.0,
	 'rongzi_changhuan': 400449456.0,
	 'rongzi_mairu': 467501491.0,
	 'rongzi_yue': 2372534574.0,
	 'stock_code': u'600832',
	 'stock_name': u'\u4e1c\u65b9\u660e\u73e0',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 254762.0,
	 'rongquan_maichu': 256962.0,
	 'rongquan_yuliang': 10000.0,
	 'rongzi_changhuan': 265115763.0,
	 'rongzi_mairu': 197919523.0,
	 'rongzi_yue': 1064784502.0,
	 'stock_code': u'600835',
	 'stock_name': u'\u4e0a\u6d77\u673a\u7535',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 43936580.0,
	 'rongquan_maichu': 43855894.0,
	 'rongquan_yuliang': 3764546.0,
	 'rongzi_changhuan': 2403578772.0,
	 'rongzi_mairu': 2079841489.0,
	 'rongzi_yue': 20028031796.0,
	 'stock_code': u'600837',
	 'stock_name': u'\u6d77\u901a\u8bc1\u5238',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 219900.0,
	 'rongquan_maichu': 231500.0,
	 'rongquan_yuliang': 12100.0,
	 'rongzi_changhuan': 66167460.0,
	 'rongzi_mairu': 76255297.0,
	 'rongzi_yue': 658811866.0,
	 'stock_code': u'600838',
	 'stock_name': u'\u4e0a\u6d77\u4e5d\u767e',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 9660434.0,
	 'rongquan_maichu': 9604234.0,
	 'rongquan_yuliang': 992700.0,
	 'rongzi_changhuan': 525973690.0,
	 'rongzi_mairu': 476974751.0,
	 'rongzi_yue': 3817254564.0,
	 'stock_code': u'600839',
	 'stock_name': u'\u56db\u5ddd\u957f\u8679',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 500.0,
	 'rongquan_maichu': 2300.0,
	 'rongquan_yuliang': 22100.0,
	 'rongzi_changhuan': 55699334.0,
	 'rongzi_mairu': 51747376.0,
	 'rongzi_yue': 471354308.0,
	 'stock_code': u'600844',
	 'stock_name': u'\u4e39\u5316\u79d1\u6280',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 22500.0,
	 'rongquan_maichu': 29300.0,
	 'rongquan_yuliang': 22062.0,
	 'rongzi_changhuan': 120974348.0,
	 'rongzi_mairu': 102947495.0,
	 'rongzi_yue': 1168347897.0,
	 'stock_code': u'600846',
	 'stock_name': u'\u540c\u6d4e\u79d1\u6280',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 800.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 18400.0,
	 'rongzi_changhuan': 155839374.0,
	 'rongzi_mairu': 124981186.0,
	 'rongzi_yue': 1051111769.0,
	 'stock_code': u'600851',
	 'stock_name': u'\u6d77\u6b23\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 65530.0,
	 'rongquan_maichu': 65530.0,
	 'rongquan_yuliang': 7800.0,
	 'rongzi_changhuan': 196460958.0,
	 'rongzi_mairu': 161288277.0,
	 'rongzi_yue': 821621038.0,
	 'stock_code': u'600855',
	 'stock_name': u'\u822a\u5929\u957f\u5cf0',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 39700.0,
	 'rongquan_maichu': 29600.0,
	 'rongquan_yuliang': 29300.0,
	 'rongzi_changhuan': 125065414.0,
	 'rongzi_mairu': 120277677.0,
	 'rongzi_yue': 1158786899.0,
	 'stock_code': u'600859',
	 'stock_name': u'\u738b\u5e9c\u4e95',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 6061883.0,
	 'rongquan_maichu': 5989183.0,
	 'rongquan_yuliang': 539300.0,
	 'rongzi_changhuan': 279753132.0,
	 'rongzi_mairu': 236746500.0,
	 'rongzi_yue': 1408353199.0,
	 'stock_code': u'600863',
	 'stock_name': u'\u5185\u8499\u534e\u7535',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 208053.0,
	 'rongquan_maichu': 234453.0,
	 'rongquan_yuliang': 214000.0,
	 'rongzi_changhuan': 210142533.0,
	 'rongzi_mairu': 130197889.0,
	 'rongzi_yue': 1670238700.0,
	 'stock_code': u'600867',
	 'stock_name': u'\u901a\u5316\u4e1c\u5b9d',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 8700.0,
	 'rongquan_maichu': 24600.0,
	 'rongquan_yuliang': 150000.0,
	 'rongzi_changhuan': 121998301.0,
	 'rongzi_mairu': 102753006.0,
	 'rongzi_yue': 1377450029.0,
	 'stock_code': u'600868',
	 'stock_name': u'\u6885\u96c1\u5409\u7965',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 163710.0,
	 'rongquan_maichu': 277700.0,
	 'rongquan_yuliang': 269090.0,
	 'rongzi_changhuan': 69699522.0,
	 'rongzi_mairu': 21435047.0,
	 'rongzi_yue': 741345359.0,
	 'stock_code': u'600872',
	 'stock_name': u'\u4e2d\u70ac\u9ad8\u65b0',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 2193811.0,
	 'rongquan_maichu': 2203811.0,
	 'rongquan_yuliang': 191000.0,
	 'rongzi_changhuan': 332095062.0,
	 'rongzi_mairu': 283455064.0,
	 'rongzi_yue': 1763703561.0,
	 'stock_code': u'600873',
	 'stock_name': u'\u6885\u82b1\u751f\u7269',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 96737.0,
	 'rongquan_maichu': 95000.0,
	 'rongquan_yuliang': 78488.0,
	 'rongzi_changhuan': 153971198.0,
	 'rongzi_mairu': 106720196.0,
	 'rongzi_yue': 702244988.0,
	 'stock_code': u'600874',
	 'stock_name': u'\u521b\u4e1a\u73af\u4fdd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 1641999.0,
	 'rongquan_maichu': 1638099.0,
	 'rongquan_yuliang': 345231.0,
	 'rongzi_changhuan': 1313359689.0,
	 'rongzi_mairu': 1409517387.0,
	 'rongzi_yue': 4152906470.0,
	 'stock_code': u'600875',
	 'stock_name': u'\u4e1c\u65b9\u7535\u6c14',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 153000.0,
	 'rongquan_maichu': 153000.0,
	 'rongquan_yuliang': 1100.0,
	 'rongzi_changhuan': 96585661.0,
	 'rongzi_mairu': 110291413.0,
	 'rongzi_yue': 705230437.0,
	 'stock_code': u'600877',
	 'stock_name': u'\u4e2d\u56fd\u5609\u9675',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 293580.0,
	 'rongquan_maichu': 292300.0,
	 'rongquan_yuliang': 58790.0,
	 'rongzi_changhuan': 327455896.0,
	 'rongzi_mairu': 352829786.0,
	 'rongzi_yue': 2447416419.0,
	 'stock_code': u'600879',
	 'stock_name': u'\u822a\u5929\u7535\u5b50',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 361167.0,
	 'rongquan_maichu': 366167.0,
	 'rongquan_yuliang': 86600.0,
	 'rongzi_changhuan': 188227319.0,
	 'rongzi_mairu': 140887853.0,
	 'rongzi_yue': 2219616538.0,
	 'stock_code': u'600880',
	 'stock_name': u'\u535a\u745e\u4f20\u64ad',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 340249.0,
	 'rongquan_maichu': 327049.0,
	 'rongquan_yuliang': 69800.0,
	 'rongzi_changhuan': 243570023.0,
	 'rongzi_mairu': 263998773.0,
	 'rongzi_yue': 2201321295.0,
	 'stock_code': u'600881',
	 'stock_name': u'\u4e9a\u6cf0\u96c6\u56e2',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 1400.0,
	 'rongquan_maichu': 400.0,
	 'rongquan_yuliang': 62000.0,
	 'rongzi_changhuan': 89725335.0,
	 'rongzi_mairu': 112271953.0,
	 'rongzi_yue': 890373176.0,
	 'stock_code': u'600884',
	 'stock_name': u'\u6749\u6749\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 8261991.0,
	 'rongquan_maichu': 8282264.0,
	 'rongquan_yuliang': 938934.0,
	 'rongzi_changhuan': 1141374158.0,
	 'rongzi_mairu': 1241975215.0,
	 'rongzi_yue': 5400608229.0,
	 'stock_code': u'600886',
	 'stock_name': u'\u56fd\u6295\u7535\u529b',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 3871073.0,
	 'rongquan_maichu': 3891701.0,
	 'rongquan_yuliang': 1607952.0,
	 'rongzi_changhuan': 408206020.0,
	 'rongzi_mairu': 530338078.0,
	 'rongzi_yue': 3861006162.0,
	 'stock_code': u'600887',
	 'stock_name': u'\u4f0a\u5229\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 1274175.0,
	 'rongquan_maichu': 1280875.0,
	 'rongquan_yuliang': 376717.0,
	 'rongzi_changhuan': 499143981.0,
	 'rongzi_mairu': 689526636.0,
	 'rongzi_yue': 3113112803.0,
	 'stock_code': u'600893',
	 'stock_name': u'\u4e2d\u822a\u52a8\u529b',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 19100.0,
	 'rongquan_maichu': 17100.0,
	 'rongquan_yuliang': 5500.0,
	 'rongzi_changhuan': 64655339.0,
	 'rongzi_mairu': 66196480.0,
	 'rongzi_yue': 860537538.0,
	 'stock_code': u'600894',
	 'stock_name': u'\u5e7f\u65e5\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 391900.0,
	 'rongquan_maichu': 383600.0,
	 'rongquan_yuliang': 127015.0,
	 'rongzi_changhuan': 258396895.0,
	 'rongzi_mairu': 196702846.0,
	 'rongzi_yue': 2036085501.0,
	 'stock_code': u'600895',
	 'stock_name': u'\u5f20\u6c5f\u9ad8\u79d1',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 5355807.0,
	 'rongquan_maichu': 5344158.0,
	 'rongquan_yuliang': 2126660.0,
	 'rongzi_changhuan': 360512848.0,
	 'rongzi_mairu': 367986437.0,
	 'rongzi_yue': 4747591137.0,
	 'stock_code': u'600900',
	 'stock_name': u'\u957f\u6c5f\u7535\u529b',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 32300.0,
	 'rongzi_changhuan': 50617781.0,
	 'rongzi_mairu': 0.0,
	 'rongzi_yue': 1556627927.0,
	 'stock_code': u'600967',
	 'stock_name': u'\u5317\u65b9\u521b\u4e1a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 218160.0,
	 'rongquan_maichu': 219160.0,
	 'rongquan_yuliang': 56300.0,
	 'rongzi_changhuan': 281120197.0,
	 'rongzi_mairu': 262281273.0,
	 'rongzi_yue': 1117821139.0,
	 'stock_code': u'600970',
	 'stock_name': u'\u4e2d\u6750\u56fd\u9645',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 3813566.0,
	 'rongquan_maichu': 3795266.0,
	 'rongquan_yuliang': 148400.0,
	 'rongzi_changhuan': 330887970.0,
	 'rongzi_mairu': 188090108.0,
	 'rongzi_yue': 685829700.0,
	 'stock_code': u'600971',
	 'stock_name': u'\u6052\u6e90\u7164\u7535',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 2000.0,
	 'rongquan_maichu': 3700.0,
	 'rongquan_yuliang': 16898.0,
	 'rongzi_changhuan': 85720658.0,
	 'rongzi_mairu': 69004027.0,
	 'rongzi_yue': 448568989.0,
	 'stock_code': u'600976',
	 'stock_name': u'\u5065\u6c11\u96c6\u56e2',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 0.0,
	 'rongzi_changhuan': 201395560.0,
	 'rongzi_mairu': 197444395.0,
	 'rongzi_yue': 1884022827.0,
	 'stock_code': u'600978',
	 'stock_name': u'\u5b9c\u534e\u6728\u4e1a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 22600.0,
	 'rongquan_maichu': 20900.0,
	 'rongquan_yuliang': 39500.0,
	 'rongzi_changhuan': 111901353.0,
	 'rongzi_mairu': 114337109.0,
	 'rongzi_yue': 684554535.0,
	 'stock_code': u'600987',
	 'stock_name': u'\u822a\u6c11\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 9300.0,
	 'rongquan_maichu': 9300.0,
	 'rongquan_yuliang': 10900.0,
	 'rongzi_changhuan': 61210982.0,
	 'rongzi_mairu': 45630880.0,
	 'rongzi_yue': 848907608.0,
	 'stock_code': u'600993',
	 'stock_name': u'\u9a6c\u5e94\u9f99',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 287820.0,
	 'rongquan_maichu': 294250.0,
	 'rongquan_yuliang': 115562.0,
	 'rongzi_changhuan': 124885734.0,
	 'rongzi_mairu': 85701023.0,
	 'rongzi_yue': 1309187636.0,
	 'stock_code': u'600998',
	 'stock_name': u'\u4e5d\u5dde\u901a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 21392154.0,
	 'rongquan_maichu': 21120210.0,
	 'rongquan_yuliang': 988963.0,
	 'rongzi_changhuan': 1131615800.0,
	 'rongzi_mairu': 1235233221.0,
	 'rongzi_yue': 6841289474.0,
	 'stock_code': u'600999',
	 'stock_name': u'\u62db\u5546\u8bc1\u5238',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 277500.0,
	 'rongquan_maichu': 277500.0,
	 'rongquan_yuliang': 0.0,
	 'rongzi_changhuan': 231730979.0,
	 'rongzi_mairu': 272358616.0,
	 'rongzi_yue': 1559501290.0,
	 'stock_code': u'601000',
	 'stock_name': u'\u5510\u5c71\u6e2f',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 497600.0,
	 'rongquan_maichu': 475900.0,
	 'rongquan_yuliang': 134800.0,
	 'rongzi_changhuan': 108159911.0,
	 'rongzi_mairu': 116165088.0,
	 'rongzi_yue': 642134685.0,
	 'stock_code': u'601001',
	 'stock_name': u'\u5927\u540c\u7164\u4e1a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 901000.0,
	 'rongquan_maichu': 900900.0,
	 'rongquan_yuliang': 23400.0,
	 'rongzi_changhuan': 339862086.0,
	 'rongzi_mairu': 315706973.0,
	 'rongzi_yue': 1381424396.0,
	 'stock_code': u'601002',
	 'stock_name': u'\u664b\u4ebf\u5b9e\u4e1a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 118700.0,
	 'rongquan_maichu': 118700.0,
	 'rongquan_yuliang': 81701.0,
	 'rongzi_changhuan': 163259194.0,
	 'rongzi_mairu': 172235624.0,
	 'rongzi_yue': 966465107.0,
	 'stock_code': u'601005',
	 'stock_name': u'\u91cd\u5e86\u94a2\u94c1',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 10246925.0,
	 'rongquan_maichu': 10518125.0,
	 'rongquan_yuliang': 2529806.0,
	 'rongzi_changhuan': 687955111.0,
	 'rongzi_mairu': 855341339.0,
	 'rongzi_yue': 5202956153.0,
	 'stock_code': u'601006',
	 'stock_name': u'\u5927\u79e6\u94c1\u8def',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 3295226.0,
	 'rongquan_maichu': 3345926.0,
	 'rongquan_yuliang': 469764.0,
	 'rongzi_changhuan': 542786891.0,
	 'rongzi_mairu': 479780440.0,
	 'rongzi_yue': 3536304411.0,
	 'stock_code': u'601009',
	 'stock_name': u'\u5357\u4eac\u94f6\u884c',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 117400.0,
	 'rongquan_maichu': 117400.0,
	 'rongquan_yuliang': 20200.0,
	 'rongzi_changhuan': 655270920.0,
	 'rongzi_mairu': 612519091.0,
	 'rongzi_yue': 2920123068.0,
	 'stock_code': u'601012',
	 'stock_name': u'\u9686\u57fa\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 6973500.0,
	 'rongquan_maichu': 6987200.0,
	 'rongquan_yuliang': 608900.0,
	 'rongzi_changhuan': 398173964.0,
	 'rongzi_mairu': 335852358.0,
	 'rongzi_yue': 1629567967.0,
	 'stock_code': u'601018',
	 'stock_name': u'\u5b81\u6ce2\u6e2f',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 451850.0,
	 'rongquan_maichu': 451950.0,
	 'rongquan_yuliang': 48068.0,
	 'rongzi_changhuan': 118281425.0,
	 'rongzi_mairu': 129539899.0,
	 'rongzi_yue': 517001815.0,
	 'stock_code': u'601038',
	 'stock_name': u'\u4e00\u62d6\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 4095850.0,
	 'rongquan_maichu': 4284200.0,
	 'rongquan_yuliang': 1844949.0,
	 'rongzi_changhuan': 1063779337.0,
	 'rongzi_mairu': 1057904397.0,
	 'rongzi_yue': 4580142249.0,
	 'stock_code': u'601088',
	 'stock_name': u'\u4e2d\u56fd\u795e\u534e',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 420017.0,
	 'rongquan_maichu': 409317.0,
	 'rongquan_yuliang': 111103.0,
	 'rongzi_changhuan': 69571340.0,
	 'rongzi_mairu': 65105606.0,
	 'rongzi_yue': 1151094772.0,
	 'stock_code': u'601098',
	 'stock_name': u'\u4e2d\u5357\u4f20\u5a92',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 1192480.0,
	 'rongquan_maichu': 1193500.0,
	 'rongquan_yuliang': 269520.0,
	 'rongzi_changhuan': 589024269.0,
	 'rongzi_mairu': 616597739.0,
	 'rongzi_yue': 4910274484.0,
	 'stock_code': u'601099',
	 'stock_name': u'\u592a\u5e73\u6d0b',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 4518248.0,
	 'rongquan_maichu': 4517963.0,
	 'rongquan_yuliang': 251072.0,
	 'rongzi_changhuan': 145464143.0,
	 'rongzi_mairu': 115606635.0,
	 'rongzi_yue': 553306102.0,
	 'stock_code': u'601101',
	 'stock_name': u'\u660a\u534e\u80fd\u6e90',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 100100.0,
	 'rongquan_maichu': 160000.0,
	 'rongquan_yuliang': 113000.0,
	 'rongzi_changhuan': 546125176.0,
	 'rongzi_mairu': 635313912.0,
	 'rongzi_yue': 2436434387.0,
	 'stock_code': u'601106',
	 'stock_name': u'\u4e2d\u56fd\u4e00\u91cd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 2670769.0,
	 'rongquan_maichu': 2623936.0,
	 'rongquan_yuliang': 931340.0,
	 'rongzi_changhuan': 373133842.0,
	 'rongzi_mairu': 474675258.0,
	 'rongzi_yue': 1844869312.0,
	 'stock_code': u'601111',
	 'stock_name': u'\u4e2d\u56fd\u56fd\u822a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 5897857.0,
	 'rongquan_maichu': 5894257.0,
	 'rongquan_yuliang': 552600.0,
	 'rongzi_changhuan': 816864757.0,
	 'rongzi_mairu': 861900010.0,
	 'rongzi_yue': 3056071677.0,
	 'stock_code': u'601117',
	 'stock_name': u'\u4e2d\u56fd\u5316\u5b66',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 2823592.0,
	 'rongquan_maichu': 2822992.0,
	 'rongquan_yuliang': 545800.0,
	 'rongzi_changhuan': 432526565.0,
	 'rongzi_mairu': 378326341.0,
	 'rongzi_yue': 2391806572.0,
	 'stock_code': u'601118',
	 'stock_name': u'\u6d77\u5357\u6a61\u80f6',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 114400.0,
	 'rongquan_maichu': 96800.0,
	 'rongquan_yuliang': 189168.0,
	 'rongzi_changhuan': 121602372.0,
	 'rongzi_mairu': 102295580.0,
	 'rongzi_yue': 372219203.0,
	 'stock_code': u'601139',
	 'stock_name': u'\u6df1\u5733\u71c3\u6c14',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 369018.0,
	 'rongquan_maichu': 364218.0,
	 'rongquan_yuliang': 142500.0,
	 'rongzi_changhuan': 129060885.0,
	 'rongzi_mairu': 135742369.0,
	 'rongzi_yue': 777010817.0,
	 'stock_code': u'601158',
	 'stock_name': u'\u91cd\u5e86\u6c34\u52a1',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 21654571.0,
	 'rongquan_maichu': 21412147.0,
	 'rongquan_yuliang': 4078975.0,
	 'rongzi_changhuan': 2530987499.0,
	 'rongzi_mairu': 2252568872.0,
	 'rongzi_yue': 15152223345.0,
	 'stock_code': u'601166',
	 'stock_name': u'\u5174\u4e1a\u94f6\u884c',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 2729247.0,
	 'rongquan_maichu': 2837147.0,
	 'rongquan_yuliang': 810700.0,
	 'rongzi_changhuan': 420030738.0,
	 'rongzi_mairu': 400057180.0,
	 'rongzi_yue': 1958204456.0,
	 'stock_code': u'601168',
	 'stock_name': u'\u897f\u90e8\u77ff\u4e1a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 5878532.0,
	 'rongquan_maichu': 5872412.0,
	 'rongquan_yuliang': 972659.0,
	 'rongzi_changhuan': 841097505.0,
	 'rongzi_mairu': 834528759.0,
	 'rongzi_yue': 6046302502.0,
	 'stock_code': u'601169',
	 'stock_name': u'\u5317\u4eac\u94f6\u884c',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 4705100.0,
	 'rongquan_maichu': 4719500.0,
	 'rongquan_yuliang': 116500.0,
	 'rongzi_changhuan': 401442058.0,
	 'rongzi_mairu': 325512390.0,
	 'rongzi_yue': 1532449048.0,
	 'stock_code': u'601179',
	 'stock_name': u'\u4e2d\u56fd\u897f\u7535',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 7617384.0,
	 'rongquan_maichu': 7716818.0,
	 'rongquan_yuliang': 1871626.0,
	 'rongzi_changhuan': 2556145529.0,
	 'rongzi_mairu': 2107875711.0,
	 'rongzi_yue': 7471893442.0,
	 'stock_code': u'601186',
	 'stock_name': u'\u4e2d\u56fd\u94c1\u5efa',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 928197.0,
	 'rongquan_maichu': 928197.0,
	 'rongquan_yuliang': 152434.0,
	 'rongzi_changhuan': 176501325.0,
	 'rongzi_mairu': 105741355.0,
	 'rongzi_yue': 1921590944.0,
	 'stock_code': u'601216',
	 'stock_name': u'\u5185\u8499\u541b\u6b63',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 0.0,
	 'rongzi_changhuan': 127453211.0,
	 'rongzi_mairu': 181899716.0,
	 'rongzi_yue': 1414580754.0,
	 'stock_code': u'601218',
	 'stock_name': u'\u5409\u946b\u79d1\u6280',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 1388900.0,
	 'rongquan_maichu': 1388500.0,
	 'rongquan_yuliang': 121800.0,
	 'rongzi_changhuan': 182574164.0,
	 'rongzi_mairu': 118223743.0,
	 'rongzi_yue': 1485252981.0,
	 'stock_code': u'601225',
	 'stock_name': u'\u9655\u897f\u7164\u4e1a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 71200.0,
	 'rongquan_maichu': 89100.0,
	 'rongquan_yuliang': 102150.0,
	 'rongzi_changhuan': 79724047.0,
	 'rongzi_mairu': 56373159.0,
	 'rongzi_yue': 532790035.0,
	 'stock_code': u'601231',
	 'stock_name': u'\u73af\u65ed\u7535\u5b50',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 268190.0,
	 'rongquan_maichu': 235290.0,
	 'rongquan_yuliang': 186500.0,
	 'rongzi_changhuan': 77482734.0,
	 'rongzi_mairu': 81480570.0,
	 'rongzi_yue': 644703310.0,
	 'stock_code': u'601238',
	 'stock_name': u'\u5e7f\u6c7d\u96c6\u56e2',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 506100.0,
	 'rongquan_maichu': 480100.0,
	 'rongquan_yuliang': 268273.0,
	 'rongzi_changhuan': 259086350.0,
	 'rongzi_mairu': 185503834.0,
	 'rongzi_yue': 1863438276.0,
	 'stock_code': u'601258',
	 'stock_name': u'\u5e9e\u5927\u96c6\u56e2',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 51257845.0,
	 'rongquan_maichu': 51647400.0,
	 'rongquan_yuliang': 6655755.0,
	 'rongzi_changhuan': 2135912993.0,
	 'rongzi_mairu': 1888387028.0,
	 'rongzi_yue': 10238872467.0,
	 'stock_code': u'601288',
	 'stock_name': u'\u519c\u4e1a\u94f6\u884c',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 5861358.0,
	 'rongquan_maichu': 4961113.0,
	 'rongquan_yuliang': 980498.0,
	 'rongzi_changhuan': 1609620501.0,
	 'rongzi_mairu': 2888952033.0,
	 'rongzi_yue': 7965756550.0,
	 'stock_code': u'601299',
	 'stock_name': u'\u4e2d\u56fd\u5317\u8f66',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 11600.0,
	 'rongquan_maichu': 7000.0,
	 'rongquan_yuliang': 24110.0,
	 'rongzi_changhuan': 130960938.0,
	 'rongzi_mairu': 92014587.0,
	 'rongzi_yue': 919078226.0,
	 'stock_code': u'601311',
	 'stock_name': u'\u9a86\u9a7c\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 5999177.0,
	 'rongquan_maichu': 5965860.0,
	 'rongquan_yuliang': 1907364.0,
	 'rongzi_changhuan': 5538705135.0,
	 'rongzi_mairu': 4907194980.0,
	 'rongzi_yue': 41994709928.0,
	 'stock_code': u'601318',
	 'stock_name': u'\u4e2d\u56fd\u5e73\u5b89',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 30962433.0,
	 'rongquan_maichu': 30766446.0,
	 'rongquan_yuliang': 2142243.0,
	 'rongzi_changhuan': 1068026715.0,
	 'rongzi_mairu': 1088796180.0,
	 'rongzi_yue': 6861759894.0,
	 'stock_code': u'601328',
	 'stock_name': u'\u4ea4\u901a\u94f6\u884c',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 7014870.0,
	 'rongquan_maichu': 7031070.0,
	 'rongquan_yuliang': 642400.0,
	 'rongzi_changhuan': 560469660.0,
	 'rongzi_mairu': 505267010.0,
	 'rongzi_yue': 1954261674.0,
	 'stock_code': u'601333',
	 'stock_name': u'\u5e7f\u6df1\u94c1\u8def',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 928674.0,
	 'rongquan_maichu': 871774.0,
	 'rongquan_yuliang': 365211.0,
	 'rongzi_changhuan': 480193447.0,
	 'rongzi_mairu': 376371130.0,
	 'rongzi_yue': 3978228392.0,
	 'stock_code': u'601336',
	 'stock_name': u'\u65b0\u534e\u4fdd\u9669',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 126500.0,
	 'rongquan_maichu': 118200.0,
	 'rongquan_yuliang': 38400.0,
	 'rongzi_changhuan': 105381372.0,
	 'rongzi_mairu': 96382445.0,
	 'rongzi_yue': 739551982.0,
	 'stock_code': u'601369',
	 'stock_name': u'\u9655\u9f13\u52a8\u529b',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 35305449.0,
	 'rongquan_maichu': 34941257.0,
	 'rongquan_yuliang': 1111778.0,
	 'rongzi_changhuan': 816346236.0,
	 'rongzi_mairu': 676835635.0,
	 'rongzi_yue': 6458183841.0,
	 'stock_code': u'601377',
	 'stock_name': u'\u5174\u4e1a\u8bc1\u5238',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 27300.0,
	 'rongquan_maichu': 33800.0,
	 'rongquan_yuliang': 48966.0,
	 'rongzi_changhuan': 125073589.0,
	 'rongzi_mairu': 83464908.0,
	 'rongzi_yue': 430906111.0,
	 'stock_code': u'601388',
	 'stock_name': u'\u6021\u7403\u8d44\u6e90',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 11067359.0,
	 'rongquan_maichu': 11077659.0,
	 'rongquan_yuliang': 3676500.0,
	 'rongzi_changhuan': 2843477384.0,
	 'rongzi_mairu': 2899507928.0,
	 'rongzi_yue': 8167075831.0,
	 'stock_code': u'601390',
	 'stock_name': u'\u4e2d\u56fd\u4e2d\u94c1',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 15214805.0,
	 'rongquan_maichu': 14683905.0,
	 'rongquan_yuliang': 7554409.0,
	 'rongzi_changhuan': 1041904024.0,
	 'rongzi_mairu': 1037539568.0,
	 'rongzi_yue': 7547050957.0,
	 'stock_code': u'601398',
	 'stock_name': u'\u5de5\u5546\u94f6\u884c',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 2900.0,
	 'rongquan_yuliang': 22100.0,
	 'rongzi_changhuan': 99277448.0,
	 'rongzi_mairu': 2077812.0,
	 'rongzi_yue': 3095807560.0,
	 'stock_code': u'601519',
	 'stock_name': u'\u5927\u667a\u6167',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 3004277.0,
	 'rongquan_maichu': 2986677.0,
	 'rongquan_yuliang': 557453.0,
	 'rongzi_changhuan': 1208734589.0,
	 'rongzi_mairu': 866053680.0,
	 'rongzi_yue': 4862783391.0,
	 'stock_code': u'601555',
	 'stock_name': u'\u4e1c\u5434\u8bc1\u5238',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 5361800.0,
	 'rongquan_maichu': 5359800.0,
	 'rongquan_yuliang': 1119100.0,
	 'rongzi_changhuan': 901945513.0,
	 'rongzi_mairu': 938767785.0,
	 'rongzi_yue': 3462536827.0,
	 'stock_code': u'601600',
	 'stock_name': u'\u4e2d\u56fd\u94dd\u4e1a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 3206683.0,
	 'rongquan_maichu': 3125279.0,
	 'rongquan_yuliang': 1638794.0,
	 'rongzi_changhuan': 863962879.0,
	 'rongzi_mairu': 930226267.0,
	 'rongzi_yue': 5985095885.0,
	 'stock_code': u'601601',
	 'stock_name': u'\u4e2d\u56fd\u592a\u4fdd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 1127862.0,
	 'rongquan_maichu': 1150170.0,
	 'rongquan_yuliang': 564239.0,
	 'rongzi_changhuan': 266236689.0,
	 'rongzi_mairu': 176636621.0,
	 'rongzi_yue': 1952766458.0,
	 'stock_code': u'601607',
	 'stock_name': u'\u4e0a\u6d77\u533b\u836f',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 39600.0,
	 'rongzi_changhuan': 8624169.0,
	 'rongzi_mairu': 0.0,
	 'rongzi_yue': 263847875.0,
	 'stock_code': u'601608',
	 'stock_name': u'\u4e2d\u4fe1\u91cd\u5de5',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 9981400.0,
	 'rongquan_maichu': 10134500.0,
	 'rongquan_yuliang': 2018843.0,
	 'rongzi_changhuan': 1078799893.0,
	 'rongzi_mairu': 1901153756.0,
	 'rongzi_yue': 3357962612.0,
	 'stock_code': u'601618',
	 'stock_name': u'\u4e2d\u56fd\u4e2d\u51b6',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 2267684.0,
	 'rongquan_maichu': 2278784.0,
	 'rongquan_yuliang': 1107869.0,
	 'rongzi_changhuan': 966350293.0,
	 'rongzi_mairu': 831466947.0,
	 'rongzi_yue': 6913406446.0,
	 'stock_code': u'601628',
	 'stock_name': u'\u4e2d\u56fd\u4eba\u5bff',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 363935.0,
	 'rongquan_maichu': 348329.0,
	 'rongquan_yuliang': 386620.0,
	 'rongzi_changhuan': 90723344.0,
	 'rongzi_mairu': 85369938.0,
	 'rongzi_yue': 783702875.0,
	 'stock_code': u'601633',
	 'stock_name': u'\u957f\u57ce\u6c7d\u8f66',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 502673.0,
	 'rongquan_maichu': 504073.0,
	 'rongquan_yuliang': 213149.0,
	 'rongzi_changhuan': 198614761.0,
	 'rongzi_mairu': 162890524.0,
	 'rongzi_yue': 827107769.0,
	 'stock_code': u'601666',
	 'stock_name': u'\u5e73\u7164\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 30803816.0,
	 'rongquan_maichu': 30932816.0,
	 'rongquan_yuliang': 3196656.0,
	 'rongzi_changhuan': 4553783813.0,
	 'rongzi_mairu': 3967763205.0,
	 'rongzi_yue': 12335169808.0,
	 'stock_code': u'601668',
	 'stock_name': u'\u4e2d\u56fd\u5efa\u7b51',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 591400.0,
	 'rongzi_changhuan': 242538629.0,
	 'rongzi_mairu': 0.0,
	 'rongzi_yue': 3486836547.0,
	 'stock_code': u'601669',
	 'stock_name': u'\u4e2d\u56fd\u7535\u5efa',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 143200.0,
	 'rongquan_maichu': 151300.0,
	 'rongquan_yuliang': 51050.0,
	 'rongzi_changhuan': 92554337.0,
	 'rongzi_mairu': 59859737.0,
	 'rongzi_yue': 642048106.0,
	 'stock_code': u'601678',
	 'stock_name': u'\u6ee8\u5316\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 18610987.0,
	 'rongquan_maichu': 19915201.0,
	 'rongquan_yuliang': 3138424.0,
	 'rongzi_changhuan': 1141452029.0,
	 'rongzi_mairu': 1025862048.0,
	 'rongzi_yue': 10888082075.0,
	 'stock_code': u'601688',
	 'stock_name': u'\u534e\u6cf0\u8bc1\u5238',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 2668654.0,
	 'rongquan_maichu': 2542830.0,
	 'rongquan_yuliang': 378003.0,
	 'rongzi_changhuan': 197029234.0,
	 'rongzi_mairu': 190421870.0,
	 'rongzi_yue': 1154987300.0,
	 'stock_code': u'601699',
	 'stock_name': u'\u6f5e\u5b89\u73af\u80fd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 318600.0,
	 'rongquan_maichu': 320300.0,
	 'rongquan_yuliang': 517700.0,
	 'rongzi_changhuan': 99033086.0,
	 'rongzi_mairu': 92460914.0,
	 'rongzi_yue': 948997361.0,
	 'stock_code': u'601717',
	 'stock_name': u'\u90d1\u7164\u673a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 384900.0,
	 'rongquan_maichu': 382200.0,
	 'rongquan_yuliang': 46200.0,
	 'rongzi_changhuan': 350785771.0,
	 'rongzi_mairu': 364571592.0,
	 'rongzi_yue': 1462178433.0,
	 'stock_code': u'601718',
	 'stock_name': u'\u9645\u534e\u96c6\u56e2',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 3053548.0,
	 'rongquan_maichu': 2871200.0,
	 'rongquan_yuliang': 902756.0,
	 'rongzi_changhuan': 1444640818.0,
	 'rongzi_mairu': 2620292510.0,
	 'rongzi_yue': 4562930338.0,
	 'stock_code': u'601727',
	 'stock_name': u'\u4e0a\u6d77\u7535\u6c14',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 8507330.0,
	 'rongquan_maichu': 7896492.0,
	 'rongquan_yuliang': 2127590.0,
	 'rongzi_changhuan': 2125457112.0,
	 'rongzi_mairu': 2581534251.0,
	 'rongzi_yue': 6202689478.0,
	 'stock_code': u'601766',
	 'stock_name': u'\u4e2d\u56fd\u5357\u8f66',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 224700.0,
	 'rongquan_maichu': 215700.0,
	 'rongquan_yuliang': 15450.0,
	 'rongzi_changhuan': 58031310.0,
	 'rongzi_mairu': 69267591.0,
	 'rongzi_yue': 833261462.0,
	 'stock_code': u'601777',
	 'stock_name': u'\u529b\u5e06\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 530100.0,
	 'rongquan_maichu': 582300.0,
	 'rongquan_yuliang': 263539.0,
	 'rongzi_changhuan': 590540057.0,
	 'rongzi_mairu': 767109372.0,
	 'rongzi_yue': 6866217380.0,
	 'stock_code': u'601788',
	 'stock_name': u'\u5149\u5927\u8bc1\u5238',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 20900.0,
	 'rongquan_maichu': 20900.0,
	 'rongquan_yuliang': 36726.0,
	 'rongzi_changhuan': 61231139.0,
	 'rongzi_mairu': 64378717.0,
	 'rongzi_yue': 713307493.0,
	 'stock_code': u'601789',
	 'stock_name': u'\u5b81\u6ce2\u5efa\u5de5',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 5327079.0,
	 'rongquan_maichu': 5367978.0,
	 'rongquan_yuliang': 1034899.0,
	 'rongzi_changhuan': 1404175929.0,
	 'rongzi_mairu': 1154110647.0,
	 'rongzi_yue': 4274449509.0,
	 'stock_code': u'601800',
	 'stock_name': u'\u4e2d\u56fd\u4ea4\u5efa',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 41600.0,
	 'rongquan_maichu': 42500.0,
	 'rongquan_yuliang': 40700.0,
	 'rongzi_changhuan': 30564563.0,
	 'rongzi_mairu': 43625659.0,
	 'rongzi_yue': 413891485.0,
	 'stock_code': u'601801',
	 'stock_name': u'\u7696\u65b0\u4f20\u5a92',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 1128494.0,
	 'rongquan_maichu': 1144694.0,
	 'rongquan_yuliang': 288086.0,
	 'rongzi_changhuan': 551212242.0,
	 'rongzi_mairu': 543585471.0,
	 'rongzi_yue': 2141528900.0,
	 'stock_code': u'601808',
	 'stock_name': u'\u4e2d\u6d77\u6cb9\u670d',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 111957970.0,
	 'rongquan_maichu': 114139943.0,
	 'rongquan_yuliang': 7373672.0,
	 'rongzi_changhuan': 928382399.0,
	 'rongzi_mairu': 942611553.0,
	 'rongzi_yue': 6472934177.0,
	 'stock_code': u'601818',
	 'stock_name': u'\u5149\u5927\u94f6\u884c',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 11258221.0,
	 'rongquan_maichu': 11302185.0,
	 'rongquan_yuliang': 2239380.0,
	 'rongzi_changhuan': 975656314.0,
	 'rongzi_mairu': 922092458.0,
	 'rongzi_yue': 4608430043.0,
	 'stock_code': u'601857',
	 'stock_name': u'\u4e2d\u56fd\u77f3\u6cb9',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 6191830.0,
	 'rongquan_maichu': 5670200.0,
	 'rongquan_yuliang': 1159795.0,
	 'rongzi_changhuan': 969536067.0,
	 'rongzi_mairu': 1041441989.0,
	 'rongzi_yue': 1960294980.0,
	 'stock_code': u'601866',
	 'stock_name': u'\u4e2d\u6d77\u96c6\u8fd0',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 209240.0,
	 'rongquan_maichu': 184300.0,
	 'rongquan_yuliang': 43200.0,
	 'rongzi_changhuan': 689348421.0,
	 'rongzi_mairu': 409085389.0,
	 'rongzi_yue': 1094816478.0,
	 'stock_code': u'601872',
	 'stock_name': u'\u62db\u5546\u8f6e\u8239',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 28500.0,
	 'rongquan_maichu': 28400.0,
	 'rongquan_yuliang': 38700.0,
	 'rongzi_changhuan': 32150766.0,
	 'rongzi_mairu': 42216352.0,
	 'rongzi_yue': 415428168.0,
	 'stock_code': u'601877',
	 'stock_name': u'\u6b63\u6cf0\u7535\u5668',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 736600.0,
	 'rongquan_maichu': 736600.0,
	 'rongquan_yuliang': 57900.0,
	 'rongzi_changhuan': 231253827.0,
	 'rongzi_mairu': 233391606.0,
	 'rongzi_yue': 1030353113.0,
	 'stock_code': u'601880',
	 'stock_name': u'\u5927\u8fde\u6e2f',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 400800.0,
	 'rongquan_maichu': 476000.0,
	 'rongquan_yuliang': 319951.0,
	 'rongzi_changhuan': 75257450.0,
	 'rongzi_mairu': 65907498.0,
	 'rongzi_yue': 749036894.0,
	 'stock_code': u'601886',
	 'stock_name': u'\u6c5f\u6cb3\u521b\u5efa',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 0.0,
	 'rongquan_maichu': 0.0,
	 'rongquan_yuliang': 351323.0,
	 'rongzi_changhuan': 6050212.0,
	 'rongzi_mairu': 0.0,
	 'rongzi_yue': 358185316.0,
	 'stock_code': u'601888',
	 'stock_name': u'\u4e2d\u56fd\u56fd\u65c5',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 2595451.0,
	 'rongquan_maichu': 2661900.0,
	 'rongquan_yuliang': 1144004.0,
	 'rongzi_changhuan': 377204632.0,
	 'rongzi_mairu': 516860229.0,
	 'rongzi_yue': 1394709164.0,
	 'stock_code': u'601898',
	 'stock_name': u'\u4e2d\u7164\u80fd\u6e90',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 19380400.0,
	 'rongquan_maichu': 19261800.0,
	 'rongquan_yuliang': 1478100.0,
	 'rongzi_changhuan': 718217937.0,
	 'rongzi_mairu': 630939756.0,
	 'rongzi_yue': 2703067045.0,
	 'stock_code': u'601899',
	 'stock_name': u'\u7d2b\u91d1\u77ff\u4e1a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 6774378.0,
	 'rongquan_maichu': 6711511.0,
	 'rongquan_yuliang': 314989.0,
	 'rongzi_changhuan': 831146657.0,
	 'rongzi_mairu': 685778306.0,
	 'rongzi_yue': 6520963760.0,
	 'stock_code': u'601901',
	 'stock_name': u'\u65b9\u6b63\u8bc1\u5238',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 1158358.0,
	 'rongquan_maichu': 1162758.0,
	 'rongquan_yuliang': 168620.0,
	 'rongzi_changhuan': 343103884.0,
	 'rongzi_mairu': 320062720.0,
	 'rongzi_yue': 1282772722.0,
	 'stock_code': u'601918',
	 'stock_name': u'\u56fd\u6295\u65b0\u96c6',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 169400.0,
	 'rongquan_maichu': 186000.0,
	 'rongquan_yuliang': 69300.0,
	 'rongzi_changhuan': 546652952.0,
	 'rongzi_mairu': 630112437.0,
	 'rongzi_yue': 1732676835.0,
	 'stock_code': u'601919',
	 'stock_name': u'\u4e2d\u56fd\u8fdc\u6d0b',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 1213600.0,
	 'rongquan_maichu': 1214500.0,
	 'rongquan_yuliang': 133400.0,
	 'rongzi_changhuan': 312802935.0,
	 'rongzi_mairu': 320473310.0,
	 'rongzi_yue': 1911841841.0,
	 'stock_code': u'601928',
	 'stock_name': u'\u51e4\u51f0\u4f20\u5a92',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 711794.0,
	 'rongquan_maichu': 734002.0,
	 'rongquan_yuliang': 38608.0,
	 'rongzi_changhuan': 124539850.0,
	 'rongzi_mairu': 103955304.0,
	 'rongzi_yue': 1358065412.0,
	 'stock_code': u'601929',
	 'stock_name': u'\u5409\u89c6\u4f20\u5a92',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 850000.0,
	 'rongquan_maichu': 866600.0,
	 'rongquan_yuliang': 455160.0,
	 'rongzi_changhuan': 154943495.0,
	 'rongzi_mairu': 183444353.0,
	 'rongzi_yue': 1838122546.0,
	 'stock_code': u'601933',
	 'stock_name': u'\u6c38\u8f89\u8d85\u5e02',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 8056660.0,
	 'rongquan_maichu': 7431660.0,
	 'rongquan_yuliang': 3982495.0,
	 'rongzi_changhuan': 839093046.0,
	 'rongzi_mairu': 718183800.0,
	 'rongzi_yue': 4141693076.0,
	 'stock_code': u'601939',
	 'stock_name': u'\u5efa\u8bbe\u94f6\u884c',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 1589600.0,
	 'rongquan_maichu': 1596600.0,
	 'rongquan_yuliang': 174399.0,
	 'rongzi_changhuan': 170564504.0,
	 'rongzi_mairu': 178658496.0,
	 'rongzi_yue': 1041564392.0,
	 'stock_code': u'601958',
	 'stock_name': u'\u91d1\u94bc\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 21144391.0,
	 'rongquan_maichu': 21085091.0,
	 'rongquan_yuliang': 4224702.0,
	 'rongzi_changhuan': 2913515721.0,
	 'rongzi_mairu': 2500823750.0,
	 'rongzi_yue': 15041027472.0,
	 'stock_code': u'601988',
	 'stock_name': u'\u4e2d\u56fd\u94f6\u884c',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 105385565.0,
	 'rongquan_maichu': 104662625.0,
	 'rongquan_yuliang': 1770114.0,
	 'rongzi_changhuan': 4163929015.0,
	 'rongzi_mairu': 3952876320.0,
	 'rongzi_yue': 14097567925.0,
	 'stock_code': u'601989',
	 'stock_name': u'\u4e2d\u56fd\u91cd\u5de5',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 2223194.0,
	 'rongquan_maichu': 2255894.0,
	 'rongquan_yuliang': 380797.0,
	 'rongzi_changhuan': 288697634.0,
	 'rongzi_mairu': 366286982.0,
	 'rongzi_yue': 1216524326.0,
	 'stock_code': u'601991',
	 'stock_name': u'\u5927\u5510\u53d1\u7535',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 1171849.0,
	 'rongquan_maichu': 1166049.0,
	 'rongquan_yuliang': 591800.0,
	 'rongzi_changhuan': 142066752.0,
	 'rongzi_mairu': 138247776.0,
	 'rongzi_yue': 1214288565.0,
	 'stock_code': u'601992',
	 'stock_name': u'\u91d1\u9685\u80a1\u4efd',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 2800.0,
	 'rongquan_maichu': 1000.0,
	 'rongquan_yuliang': 10500.0,
	 'rongzi_changhuan': 51859466.0,
	 'rongzi_mairu': 51486740.0,
	 'rongzi_yue': 609550743.0,
	 'stock_code': u'601996',
	 'stock_name': u'\u4e30\u6797\u96c6\u56e2',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 3592857.0,
	 'rongquan_maichu': 3495357.0,
	 'rongquan_yuliang': 1271953.0,
	 'rongzi_changhuan': 372976014.0,
	 'rongzi_mairu': 392838525.0,
	 'rongzi_yue': 2499837405.0,
	 'stock_code': u'601998',
	 'stock_name': u'\u4e2d\u4fe1\u94f6\u884c',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 65200.0,
	 'rongquan_maichu': 54000.0,
	 'rongquan_yuliang': 5300.0,
	 'rongzi_changhuan': 52599941.0,
	 'rongzi_mairu': 41085238.0,
	 'rongzi_yue': 470668932.0,
	 'stock_code': u'601999',
	 'stock_name': u'\u51fa\u7248\u4f20\u5a92',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 121037.0,
	 'rongquan_maichu': 120637.0,
	 'rongquan_yuliang': 146658.0,
	 'rongzi_changhuan': 235242097.0,
	 'rongzi_mairu': 198422068.0,
	 'rongzi_yue': 2050355658.0,
	 'stock_code': u'603000',
	 'stock_name': u'\u4eba\u6c11\u7f51',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
2015-04-27 19:53:31+0800 [shrongzi] ERROR: Error processing {'market': 'sh',
	 'rongquan_changhuan': 950641.0,
	 'rongquan_maichu': 950141.0,
	 'rongquan_yuliang': 101500.0,
	 'rongzi_changhuan': 199969639.0,
	 'rongzi_mairu': 98659939.0,
	 'rongzi_yue': 511128579.0,
	 'stock_code': u'603993',
	 'stock_name': u'\u6d1b\u9633\u94bc\u4e1a',
	 'trading_day': datetime.datetime(2015, 4, 20, 0, 0)}
	Traceback (most recent call last):
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/middleware.py", line 62, in _process_chain
	    return process_chain(self.methods[methodname], obj, *args)
	  File "/home/python/pydev/lib/python2.7/site-packages/scrapy/utils/defer.py", line 65, in process_chain
	    d.callback(input)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 383, in callback
	    self._startRunCallbacks(result)
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 491, in _startRunCallbacks
	    self._runCallbacks()
	--- <exception caught here> ---
	  File "/home/python/pydev/lib/python2.7/site-packages/twisted/internet/defer.py", line 578, in _runCallbacks
	    current.result = callback(current.result, *args, **kw)
	  File "/home/lxq/python/finance_crawl/szrongzi/szrongzi/pipelines.py", line 45, in process_item
	    stock_codes = [x.stock_code for x in db.query(db.Stock_info).all()]
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2323, in all
	    return list(self)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2441, in __iter__
	    return self._execute_and_instances(context)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2454, in _execute_and_instances
	    close_with_result=True)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/query.py", line 2445, in _connection_from_session
	    **kw)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 880, in connection
	    execution_options=execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 885, in _connection_for_bind
	    engine, execution_options)
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 305, in _connection_for_bind
	    self._assert_active()
	  File "/home/python/pydev/lib/python2.7/site-packages/sqlalchemy/orm/session.py", line 214, in _assert_active
	    % self._rollback_exception
	sqlalchemy.exc.InvalidRequestError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (IntegrityError) 错误:  重复键违反唯一约束"rongzi_mingxi_trading_day_stock_code_key"
	DETAIL:  键值"(trading_day, stock_code)=(2015-04-20, 510010)" 已经存在
	 'INSERT INTO rongzi_mingxi (trading_day, market, stock_code, rongzi_yue, rongzi_mairu, rongzi_changhuan, rongquan_yuliang, rongquan_maichu, rongquan_changhuan) VALUES (%(trading_day)s, %(market)s, %(stock_code)s, %(rongzi_yue)s, %(rongzi_mairu)s, %(rongzi_changhuan)s, %(rongquan_yuliang)s, %(rongquan_maichu)s, %(rongquan_changhuan)s) RETURNING rongzi_mingxi.data_id' {'trading_day': datetime.datetime(2015, 4, 20, 0, 0), 'stock_code': u'510010', 'rongzi_yue': 48206149.0, 'rongzi_changhuan': 3471366.0, 'rongquan_maichu': None, 'rongquan_changhuan': 341800.0, 'rongzi_mairu': 4316576.0, 'rongquan_yuliang': 3958000.0, 'market': 'sh'}
	
